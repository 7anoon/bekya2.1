var e=Object.defineProperty,t=Object.defineProperties,i=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertyNames,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(t,i,n)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[i]=n,a=(e,t)=>{for(var i in t||(t={}))o.call(t,i)&&l(e,i,t[i]);if(r)for(var i of r(t))s.call(t,i)&&l(e,i,t[i]);return e},d=(e,n)=>t(e,i(n)),c=(e,t,i)=>new Promise((n,r)=>{var o=e=>{try{l(i.next(e))}catch(t){r(t)}},s=e=>{try{l(i.throw(e))}catch(t){r(t)}},l=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,s);l((i=i.apply(e,t)).next())});import{r as p,a as x,g as u,R as g,u as h,L as f,b as m,B as y,c as b,d as j,N as v}from"./react-vendor-Gq4blHEi.js";import{c as w}from"./supabase-CbUG4vy5.js";var S,_,C=(S={"assets/index-hDloNVSt.js"(e){!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var t={exports:{}},i={},n=p,r=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,S=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,i){var n,o={},l=null,a=null;for(n in void 0!==i&&(l=""+i),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(a=t.ref),t)s.call(t,n)&&!_.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:r,type:e,key:l,ref:a,props:o,_owner:S.current}}i.Fragment=o,i.jsx=C,i.jsxs=C,t.exports=i;var k=t.exports,N={},B=x;N.createRoot=B.createRoot,N.hydrateRoot=B.hydrateRoot;const z=e=>{let t;const i=new Set,n=(e,n)=>{const r="function"==typeof e?e(t):e;if(!Object.is(r,t)){const e=t;t=(null!=n?n:"object"!=typeof r||null===r)?r:Object.assign({},t,r),i.forEach(i=>i(t,e))}},r=()=>t,o={setState:n,getState:r,getInitialState:()=>s,subscribe:e=>(i.add(e),()=>i.delete(e)),destroy:()=>{i.clear()}},s=t=e(n,r,o);return o};var I={exports:{}},W={},T={exports:{}},R={},D=p,E="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},P=D.useState,L=D.useEffect,A=D.useLayoutEffect,q=D.useDebugValue;function $(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!E(e,i)}catch(n){return!0}}var O="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var i=t(),n=P({inst:{value:i,getSnapshot:t}}),r=n[0].inst,o=n[1];return A(function(){r.value=i,r.getSnapshot=t,$(r)&&o({inst:r})},[e,i,t]),L(function(){return $(r)&&o({inst:r}),e(function(){$(r)&&o({inst:r})})},[e]),q(i),i};R.useSyncExternalStore=void 0!==D.useSyncExternalStore?D.useSyncExternalStore:O,T.exports=R;var F=T.exports,H=p,M=F,U="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},G=M.useSyncExternalStore,V=H.useRef,Z=H.useEffect,Y=H.useMemo,J=H.useDebugValue;
/**
     * @license React
     * use-sync-external-store-shim/with-selector.production.js
     *
     * Copyright (c) Meta Platforms, Inc. and affiliates.
     *
     * This source code is licensed under the MIT license found in the
     * LICENSE file in the root directory of this source tree.
     */W.useSyncExternalStoreWithSelector=function(e,t,i,n,r){var o=V(null);if(null===o.current){var s={hasValue:!1,value:null};o.current=s}else s=o.current;o=Y(function(){function e(e){if(!a){if(a=!0,o=e,e=n(e),void 0!==r&&s.hasValue){var t=s.value;if(r(t,e))return l=t}return l=e}if(t=l,U(o,e))return t;var i=n(e);return void 0!==r&&r(t,i)?(o=e,t):(o=e,l=i)}var o,l,a=!1,d=void 0===i?null:i;return[function(){return e(t())},null===d?void 0:function(){return e(d())}]},[t,i,n,r]);var l=G(e,o[0],o[1]);return Z(function(){s.hasValue=!0,s.value=l},[l]),J(l),l},I.exports=W;var X=I.exports;const K=u(X),Q={},{useDebugValue:ee}=g,{useSyncExternalStoreWithSelector:te}=K;let ie=!1;const ne=e=>e,re=e=>{const t="function"==typeof e?(e=>e?z(e):z)(e):e,i=(e,i)=>function(e,t=ne,i){"production"!==(Q?"production":void 0)&&i&&!ie&&(ie=!0);const n=te(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,i);return ee(n),n}(t,e,i);return Object.assign(i,t),i},oe=e=>e?re(e):re;let se=null;const le=function(){if(se)return se;try{return se=function(){try{const t=w("https://kxuvoovqvtwhtxjnnboo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt4dXZvb3ZxdnR3aHR4am5uYm9vIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5Mjc1MzUsImV4cCI6MjA4NDUwMzUzNX0.4jLdfrpRlBwzfvPdYpnQQM_n48HYEYkRnrIooUasrXw",{auth:{storage:window.localStorage,persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"bekya-auth-token"},global:{headers:{"x-client-info":"bekya-app"}},db:{schema:"public"},realtime:{timeout:3e4}});try{t.auth.onAuthStateChange((e,t)=>{var i;null==(i=null==t?void 0:t.user)||i.id})}catch(e){}return t}catch(e){throw e}}(),se}catch(e){throw e}}(),ae=oe(t=>({user:null,profile:null,error:null,isLoading:!0,setUser:e=>t({user:e}),setProfile:e=>t({profile:e}),setError:e=>t({error:e}),signUp:(i,n,r,o,s)=>c(e,null,function*(){t({error:null,isLoading:!0});const e=setTimeout(()=>{throw new Error("Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„. ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰")},15e3);try{if(!i||i.length<3)throw new Error("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 3 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");if(!n||!n.includes("@"))throw new Error("Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­");if(!r||r.length<6)throw new Error("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");if(!s||s.length<11)throw new Error("Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ØºÙŠØ± ØµØ­ÙŠØ­");const{data:l,error:a}=yield le.from("profiles").select("username").eq("username",i).maybeSingle();if(a&&!a.message.includes("No rows"))throw new Error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰");if(l)throw new Error("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„. Ø§Ø®ØªØ± Ø§Ø³Ù…Ø§Ù‹ Ø¢Ø®Ø±");const{data:d,error:c}=yield le.auth.signUp({email:n,password:r,options:{data:{username:i,location:o,phone:s},emailRedirectTo:window.location.origin+"/bekya2.1/"}});if(c){if(c.message.includes("already registered"))throw new Error("Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„");if(c.message.includes("User already registered"))throw new Error("Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„");if(422===c.status)throw new Error("Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©. ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±");throw new Error(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„: ${c.message}`)}if(d.user&&!d.session)throw new Error("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ. ÙŠØ±Ø¬Ù‰ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø£ÙˆÙ„Ø§Ù‹");if(d.user){const{error:e}=yield le.from("profiles").upsert({id:d.user.id,username:i,email:n,location:o,phone:s,role:"user"},{onConflict:"id"});if(e)throw new Error("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ù„ÙƒÙ† Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù…")}return clearTimeout(e),t({isLoading:!1}),d}catch(l){clearTimeout(e);const i=l.message||"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰";throw t({error:i,isLoading:!1}),new Error(i)}}),signIn:(i,n)=>c(e,null,function*(){var e,r,o,s,l;t({error:null,isLoading:!0});const a=setTimeout(()=>{throw t({isLoading:!1}),new Error("Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„. ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª")},15e3);try{if(!i||0===i.trim().length)throw clearTimeout(a),t({isLoading:!1}),new Error("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ");if(!n||0===n.length)throw clearTimeout(a),t({isLoading:!1}),new Error("Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±");const c=i.includes("@");let p=i;if(!c)try{const{data:t,error:n}=yield le.from("profiles").select("email").eq("username",i.trim()).single();if(n){if(null==(e=n.message)?void 0:e.includes("fetch"))throw new Error("Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª");throw new Error("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯. ØªØ£ÙƒØ¯ Ù…Ù† ÙƒØªØ§Ø¨ØªÙ‡ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­")}if(!t)throw new Error("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯. ØªØ£ÙƒØ¯ Ù…Ù† ÙƒØªØ§Ø¨ØªÙ‡ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­");p=t.email}catch(d){throw clearTimeout(a),t({isLoading:!1}),d}const{data:x,error:u}=yield le.auth.signInWithPassword({email:p,password:n});if(u){if(clearTimeout(a),t({isLoading:!1}),null==(r=u.message)?void 0:r.includes("Invalid login credentials"))throw new Error("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©");if(null==(o=u.message)?void 0:o.includes("Email not confirmed"))throw new Error("ÙŠØ¬Ø¨ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£ÙˆÙ„Ø§Ù‹");if((null==(s=u.message)?void 0:s.includes("fetch"))||(null==(l=u.message)?void 0:l.includes("network")))throw new Error("Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª");throw new Error("Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰")}if(!(null==x?void 0:x.user))throw clearTimeout(a),t({isLoading:!1}),new Error("ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰");const{data:g,error:h}=yield le.from("profiles").select("*").eq("id",x.user.id).single();return clearTimeout(a),t({user:x.user,profile:g,isLoading:!1}),x}catch(c){clearTimeout(a);const e=c.message||"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰";throw t({error:e,isLoading:!1}),c}}),signOut:()=>c(e,null,function*(){t({error:null});try{t({user:null,profile:null});const e=[];for(let t=0;t<localStorage.length;t++){const i=localStorage.key(t);i&&i.startsWith("sb-")&&e.push(i)}e.forEach(e=>localStorage.removeItem(e)),yield le.auth.signOut().catch(()=>{})}catch(e){t({user:null,profile:null})}}),loadUser:()=>c(e,null,function*(){t({error:null,isLoading:!0});try{/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)&&(yield new Promise(e=>setTimeout(e,300)));const i=new Promise((e,t)=>setTimeout(()=>t(new Error("timeout")),1e4)),n=le.auth.getSession(),{data:{session:r}}=yield Promise.race([n,i]);if(!(null==r?void 0:r.user))return void t({user:null,profile:null,isLoading:!1});t({user:r.user,isLoading:!1});let o=3,s=null;for(;o>0&&!s;)try{const{data:e,error:t}=yield le.from("profiles").select("*").eq("id",r.user.id).single();t?(o--,o>0&&(yield new Promise(e=>setTimeout(e,1e3)))):s=e}catch(e){o--,o>0&&(yield new Promise(e=>setTimeout(e,1e3)))}t({profile:s||{id:r.user.id,email:r.user.email,role:"user"}})}catch(i){i.message,t({user:null,profile:null,isLoading:!1})}})}));class de extends p.Component{constructor(e){var t;super(e),l(this,"symbol"!=typeof(t="handleReset")?t+"":t,()=>{this.setState({hasError:!1,error:null}),window.location.reload()}),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}render(){return this.state.hasError?k.jsx("div",{style:ce.container,children:k.jsxs("div",{style:ce.content,children:[k.jsx("div",{style:ce.icon,children:"âš ï¸"}),k.jsx("h1",{style:ce.title,children:"Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£"}),k.jsx("p",{style:ce.message,children:"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹. ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© ÙˆØ§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰."}),k.jsx("button",{onClick:this.handleReset,style:ce.button,className:"btn btn-primary",children:"ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©"})]})}):this.props.children}}const ce={container:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},content:{textAlign:"center",padding:"40px",maxWidth:"500px"},icon:{fontSize:"80px",marginBottom:"24px"},title:{fontSize:"32px",fontWeight:"700",color:"#f9fafb",marginBottom:"16px"},message:{fontSize:"18px",color:"#d1d5db",lineHeight:"1.6",marginBottom:"32px"},button:{padding:"16px 48px",fontSize:"16px",fontWeight:"700",cursor:"pointer"}};function pe(){const[e,t]=p.useState(navigator.onLine),[i,n]=p.useState(!1);return p.useEffect(()=>{const e=()=>{t(!0),n(!0),setTimeout(()=>n(!1),3e3)},i=()=>{t(!1),n(!0)};return window.addEventListener("online",e),window.addEventListener("offline",i),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",i)}},[]),i?k.jsxs("div",{style:{position:"fixed",top:"80px",left:"50%",transform:"translateX(-50%)",zIndex:1e4,padding:"16px 24px",borderRadius:"12px",background:e?"linear-gradient(135deg, #10b981 0%, #059669 100%)":"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"white",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.2)",display:"flex",alignItems:"center",gap:"12px",animation:"slideDown 0.3s ease-out",fontWeight:"600"},children:[k.jsx("span",{style:{fontSize:"20px"},children:e?"âœ“":"âš "}),k.jsx("span",{children:e?"Ø¹Ø§Ø¯ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª":"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª"})]}):null}function xe({error:e,onRetry:t,onDismiss:i}){if(!e)return null;const n=e=>e.includes("Ø¥Ù†ØªØ±Ù†Øª")||e.includes("Ø§ØªØµØ§Ù„")||e.includes("Ù…Ù‡Ù„Ø©")?"ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰":e.includes("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±")?"ØªØ£ÙƒØ¯ Ù…Ù† ÙƒØªØ§Ø¨Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­":e.includes("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯")?"Ø¬Ø±Ø¨ Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… Ø¢Ø®Ø±":e.includes("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯")?"ØªØ£ÙƒØ¯ Ù…Ù† ÙƒØªØ§Ø¨Ø© Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­":e.includes("500 Ø¬Ù†ÙŠÙ‡")?"Ø¨ÙŠÙƒÙŠØ§ ØªÙ‚Ø¨Ù„ ÙÙ‚Ø· Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªÙŠ Ø³Ø¹Ø±Ù‡Ø§ Ø§Ù„Ø£ØµÙ„ÙŠ Ø£Ù‚Ù„ Ù…Ù† 500 Ø¬Ù†ÙŠÙ‡":null;return k.jsxs("div",{style:ue.container,children:[k.jsxs("div",{style:ue.content,children:[k.jsx("div",{style:ue.icon,children:(r=e,r.includes("Ø¥Ù†ØªØ±Ù†Øª")||r.includes("Ø§ØªØµØ§Ù„")?"ðŸ“¡":r.includes("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±")?"ðŸ”’":r.includes("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…")?"ðŸ‘¤":r.includes("Ø¨Ø±ÙŠØ¯")?"ðŸ“§":r.includes("ØµÙˆØ±Ø©")?"ðŸ–¼ï¸":r.includes("Ø³Ø¹Ø±")?"ðŸ’°":"âš ï¸")}),k.jsxs("div",{style:ue.textContainer,children:[k.jsx("div",{style:ue.errorText,children:e}),n(e)&&k.jsx("div",{style:ue.suggestion,children:n(e)})]})]}),k.jsxs("div",{style:ue.actions,children:[t&&k.jsx("button",{onClick:t,style:ue.retryButton,children:"Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©"}),i&&k.jsx("button",{onClick:i,style:ue.dismissButton,children:"âœ•"})]})]});var r}const ue={container:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"12px",padding:"16px",marginBottom:"20px",display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"12px",animation:"shake 0.5s ease-in-out"},content:{display:"flex",gap:"12px",flex:1},icon:{fontSize:"24px",flexShrink:0},textContainer:{display:"flex",flexDirection:"column",gap:"8px",flex:1},errorText:{color:"#fca5a5",fontSize:"14px",fontWeight:"600",lineHeight:"1.5"},suggestion:{color:"#fcd34d",fontSize:"13px",lineHeight:"1.4"},actions:{display:"flex",gap:"8px",alignItems:"center"},retryButton:{background:"rgba(239, 68, 68, 0.2)",border:"1px solid rgba(239, 68, 68, 0.4)",color:"#fca5a5",padding:"6px 12px",borderRadius:"8px",fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",whiteSpace:"nowrap"},dismissButton:{background:"transparent",border:"none",color:"#fca5a5",fontSize:"18px",cursor:"pointer",padding:"4px 8px",opacity:.7,transition:"opacity 0.2s ease"}};function ge(){const[e,t]=p.useState(""),[i,n]=p.useState(""),[r,o]=p.useState(""),[s,l]=p.useState(!1),{signIn:a}=ae(),d=h(),x=t=>c(this,null,function*(){var n,r;t.preventDefault(),o(""),l(!0);try{yield a(e,i),yield new Promise(e=>setTimeout(e,500)),d("/")}catch(s){let e=s.message||"Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„";(null==(n=s.message)?void 0:n.includes("fetch"))?e="Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª":(null==(r=s.message)?void 0:r.includes("network"))&&(e="Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰"),o(e),l(!1)}});return k.jsx("div",{style:he.container,children:k.jsx("div",{style:he.content,children:k.jsxs("div",{className:"card",style:he.card,children:[k.jsxs("div",{style:he.header,children:[k.jsx("h1",{style:he.logo,children:"Ø¨ÙŠÙƒÙŠØ§"}),k.jsx("p",{style:he.tagline,children:"Ø§Ù„Ø­Ø§Ø¬Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ù„Ø³Ù‡ Ù„ÙŠÙ‡Ø§ Ù‚ÙŠÙ…Ø©"})]}),k.jsx("h2",{style:he.title,children:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„"}),k.jsx(xe,{error:r,onRetry:()=>x({preventDefault:()=>{}}),onDismiss:()=>o("")}),k.jsxs("form",{onSubmit:x,style:he.form,children:[k.jsxs("div",{style:he.field,children:[k.jsx("label",{style:he.label,children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"}),k.jsx("input",{type:"text",className:"input",style:he.input,value:e,onChange:e=>t(e.target.value),placeholder:"",autoComplete:"off",required:!0,disabled:s})]}),k.jsxs("div",{style:he.field,children:[k.jsx("label",{style:he.label,children:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"}),k.jsx("input",{type:"password",className:"input",style:he.input,value:i,onChange:e=>n(e.target.value),required:!0,disabled:s})]}),k.jsx("button",{type:"submit",className:"btn btn-primary",style:he.button,disabled:s,children:s?"Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...":"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„"})]}),k.jsx("div",{style:he.footer,children:k.jsxs("p",{style:he.footerText,children:["Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ"," ",k.jsx(f,{to:"/signup",style:he.link,children:"Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†"})]})})]})})})}const he={container:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},content:{width:"100%",maxWidth:"450px"},card:{padding:"48px 40px"},header:{textAlign:"center",marginBottom:"40px"},logo:{fontSize:"48px",fontWeight:"900",marginBottom:"12px",background:"linear-gradient(135deg, #6b7c59 0%, #8b7355 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},tagline:{fontSize:"16px",color:"#9ca3af"},title:{fontSize:"28px",fontWeight:"700",color:"#f9fafb",marginBottom:"32px",textAlign:"center"},form:{display:"flex",flexDirection:"column",gap:"20px"},field:{display:"flex",flexDirection:"column",gap:"8px"},label:{fontSize:"14px",fontWeight:"600",color:"#e5e7eb"},input:{width:"100%"},button:{width:"100%",marginTop:"8px"},footer:{marginTop:"32px",paddingTop:"24px",borderTop:"1px solid rgba(107, 124, 89, 0.2)",textAlign:"center"},footerText:{fontSize:"14px",color:"#9ca3af"},link:{color:"#6b7c59",fontWeight:"600",textDecoration:"none",transition:"color 0.3s ease"}};function fe(){const[e,t]=p.useState({username:"",email:"",password:"",location:"",phone:""}),[i,n]=p.useState(""),[r,o]=p.useState(!1),{signUp:s}=ae();h();const l=i=>{t(d(a({},e),{[i.target.name]:i.target.value}))};return k.jsxs("div",{style:me.container,className:"signup-container",children:[k.jsx("div",{style:me.leftSide,className:"signup-left-side",children:k.jsxs("div",{style:me.brandContainer,children:[k.jsx("h1",{style:me.brandTitle,children:"Ø¨ÙŠÙƒÙŠØ§ Ø¨ØªÙ†Ø§Ø¯ÙŠÙƒ!"}),k.jsx("p",{style:me.brandSubtitle,children:"Ø§Ù†Ø¶Ù… Ù„Ù…Ø¬ØªÙ…Ø¹Ù†Ø§ Ø§Ù„ÙŠÙˆÙ…"}),k.jsxs("p",{style:me.brandDescription,children:["Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ ÙÙŠ Ø¨ÙŠØ¹ ÙˆØ´Ø±Ø§Ø¡ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",k.jsx("br",{}),"Ù…Ø¹ Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ÙˆØ£Ø³Ù‡Ù„ Ø§Ù„Ø·Ø±Ù‚"]})]})}),k.jsxs("div",{className:"card signup-card",style:me.card,children:[k.jsx("div",{className:"mobile-brand-header",children:k.jsx("h1",{style:me.mobileBrandTitle,children:"Ø¨ÙŠÙƒÙŠØ§ Ø¨ØªÙ†Ø§Ø¯ÙŠÙƒ!"})}),k.jsx("h1",{style:me.title,className:"signup-title",children:"Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯"}),i&&k.jsx("div",{style:me.error,children:i}),k.jsxs("form",{onSubmit:t=>c(this,null,function*(){t.preventDefault(),n(""),o(!0);try{const t=yield s(e.username,e.email,e.password,e.location,e.phone);t&&t.user?window.location.href="/bekya2.1/":(n("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰"),o(!1))}catch(i){n(i.message||"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„"),o(!1)}}),style:me.form,children:[k.jsxs("div",{style:me.field,children:[k.jsx("label",{style:me.label,children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"}),k.jsx("input",{type:"text",name:"username",className:"input",value:e.username,onChange:l,required:!0})]}),k.jsxs("div",{style:me.field,children:[k.jsx("label",{style:me.label,children:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"}),k.jsx("input",{type:"email",name:"email",className:"input",value:e.email,onChange:l,required:!0})]}),k.jsxs("div",{style:me.field,children:[k.jsx("label",{style:me.label,children:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"}),k.jsx("input",{type:"password",name:"password",className:"input",value:e.password,onChange:l,required:!0,minLength:6})]}),k.jsxs("div",{style:me.field,children:[k.jsx("label",{style:me.label,children:"Ø§Ù„Ù…ÙˆÙ‚Ø¹ / Ø§Ù„Ù…Ù†Ø·Ù‚Ø©"}),k.jsx("input",{type:"text",name:"location",className:"input",value:e.location,onChange:l,placeholder:"Ù…Ø«Ø§Ù„: Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© - Ù…Ø¯ÙŠÙ†Ø© Ù†ØµØ±",required:!0})]}),k.jsxs("div",{style:me.field,children:[k.jsx("label",{style:me.label,children:"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ"}),k.jsx("input",{type:"tel",name:"phone",className:"input",value:e.phone,onChange:l,required:!0})]}),k.jsx("button",{type:"submit",className:"btn btn-primary",style:me.submitBtn,disabled:r,children:r?"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...":"ØªØ³Ø¬ÙŠÙ„"})]}),k.jsxs("p",{style:me.footer,children:["Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ ",k.jsx(f,{to:"/login",style:me.link,children:"Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„"})]})]})]})}const me={container:{minHeight:"100vh",display:"flex",justifyContent:"flex-end",alignItems:"stretch",padding:"0"},leftSide:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"60px"},brandContainer:{maxWidth:"600px"},brandTitle:{fontSize:"72px !important",fontWeight:"900 !important",color:"#000000 !important",marginBottom:"20px",textShadow:"none !important",fontFamily:"'Cairo', 'Segoe UI', sans-serif",lineHeight:"1.2",WebkitTextFillColor:"#000000"},brandSubtitle:{fontSize:"32px",color:"#1a1a1a",marginBottom:"16px",fontWeight:"700"},brandDescription:{fontSize:"22px",color:"#2d2d2d",lineHeight:"1.8",fontWeight:"500"},card:{maxWidth:"550px",width:"100%",minHeight:"100vh",padding:"60px 50px",borderRadius:"0",display:"flex",flexDirection:"column",justifyContent:"center",overflowY:"auto"},title:{fontSize:"28px",marginBottom:"24px",textAlign:"center",color:"#10b981"},error:{background:"#fee2e2",color:"#dc2626",padding:"12px",borderRadius:"8px",marginBottom:"16px",textAlign:"center"},form:{display:"flex",flexDirection:"column",gap:"16px"},field:{display:"flex",flexDirection:"column",gap:"8px"},label:{fontWeight:"600",color:"#374151"},submitBtn:{width:"100%",marginTop:"8px"},footer:{marginTop:"20px",textAlign:"center",color:"#6b7280"},link:{color:"#10b981",fontWeight:"600",textDecoration:"none"},mobileBrandTitle:{fontSize:"36px",fontWeight:"900",color:"#000000",textAlign:"center",marginBottom:"0",display:"none"}};if("undefined"!=typeof window){const e=document.createElement("style");e.textContent="\n    .mobile-brand-header {\n      display: none;\n    }\n    \n    @media (max-width: 768px) {\n      .signup-container {\n        flex-direction: column !important;\n        padding: 0 !important;\n      }\n      \n      .signup-left-side {\n        display: none !important;\n      }\n      \n      .mobile-brand-header {\n        display: block !important;\n        background: linear-gradient(135deg, #1e4d3d 0%, #2d6a4f 50%, #40916c 100%);\n        padding: 40px 20px;\n        margin: -30px -20px 30px -20px;\n        border-radius: 16px 16px 0 0;\n      }\n      \n      .mobile-brand-header h1 {\n        display: block !important;\n        color: #ffffff !important;\n        text-shadow: 2px 2px 4px rgba(0,0,0,0.2);\n      }\n      \n      .signup-card {\n        max-width: 100% !important;\n        min-height: auto !important;\n        padding: 30px 20px !important;\n        border-radius: 16px !important;\n        margin: 20px;\n      }\n      \n      .signup-title {\n        font-size: 24px !important;\n      }\n    }\n    \n    @media (max-width: 480px) {\n      .mobile-brand-header {\n        padding: 30px 16px;\n        margin: -20px -16px 20px -16px;\n      }\n      \n      .mobile-brand-header h1 {\n        font-size: 28px !important;\n      }\n      \n      .signup-card {\n        padding: 20px 16px !important;\n        margin: 16px;\n      }\n      \n      .signup-title {\n        font-size: 22px !important;\n      }\n    }\n  ",document.head.appendChild(e)}const ye=new class{constructor(){this.cache=new Map,this.maxAge=3e5}generateKey(e,t={}){const i=Object.keys(t).sort().reduce((e,i)=>(e[i]=t[i],e),{});return`${e}_${JSON.stringify(i)}`}set(e,t,i=this.maxAge){const n={data:t,timestamp:Date.now(),expiresAt:Date.now()+i};this.cache.set(e,n)}get(e){const t=this.cache.get(e);return t?Date.now()>t.expiresAt?(this.cache.delete(e),null):t.data:null}hasValid(e){const t=this.cache.get(e);return t&&Date.now()<=t.expiresAt}cleanup(){const e=Date.now();for(const[t,i]of this.cache.entries())e>i.expiresAt&&this.cache.delete(t)}clear(){this.cache.clear()}getStats(){const e=Date.now();let t=0,i=0;for(const n of this.cache.values())e<=n.expiresAt?t++:i++;return{total:this.cache.size,valid:t,expired:i,hitRate:t+i>0?(t/(t+i)*100).toFixed(1)+"%":"0%"}}};setInterval(()=>{ye.cleanup()},6e5);const be=oe((t,i)=>({products:[],loading:!1,analyzeProduct:(t,i,n,r,o="",s="")=>c(e,null,function*(){const e=(o+" "+s).toLowerCase().trim(),t=parseInt(r),i={"Ù…Ù…ØªØ§Ø²Ø©":["Ø¬Ø¯ÙŠØ¯","Ø´Ø¨Ù‡ Ø¬Ø¯ÙŠØ¯","Ù…Ù…ØªØ§Ø²","Ø²ÙŠØ±Ùˆ","Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ø®ÙÙŠÙ","Ù†Ø¸ÙŠÙ Ø¬Ø¯Ø§","Ø¨Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯","Ù„Ù… ÙŠØ³ØªØ®Ø¯Ù…"],"Ø¬ÙŠØ¯Ø© Ø¬Ø¯Ø§Ù‹":["Ø¬ÙŠØ¯ Ø¬Ø¯Ø§","Ø­Ø§Ù„Ø© Ø¬ÙŠØ¯Ø© Ø¬Ø¯Ø§","Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ø¨Ø³ÙŠØ·","Ù†Ø¸ÙŠÙ","Ø´Ø¨Ù‡ Ø¬Ø¯ÙŠØ¯"],"Ø¬ÙŠØ¯Ø©":["Ø¬ÙŠØ¯","Ø­Ø§Ù„Ø© Ø¬ÙŠØ¯Ø©","Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ø¹Ø§Ø¯ÙŠ","Ù…Ø³ØªØ¹Ù…Ù„","Ù†Ø¸ÙŠÙ"],"Ù…ØªÙˆØ³Ø·Ø©":["Ù…ØªÙˆØ³Ø·","Ø­Ø§Ù„Ø© Ù…ØªÙˆØ³Ø·Ø©","Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÙƒØ«ÙŠØ±","Ø¨Ù‡ Ø®Ø¯ÙˆØ´","Ø¨Ù‡ Ø¹ÙŠÙˆØ¨ Ø¨Ø³ÙŠØ·Ø©"],"Ù…Ù‚Ø¨ÙˆÙ„Ø©":["Ù…Ù‚Ø¨ÙˆÙ„","Ø­Ø§Ù„Ø© Ù…Ù‚Ø¨ÙˆÙ„Ø©","ÙŠØ­ØªØ§Ø¬ ØµÙŠØ§Ù†Ø©","Ø¨Ù‡ Ø¹ÙŠÙˆØ¨","Ù‚Ø¯ÙŠÙ…","Ù…ØªÙ‡Ø§Ù„Ùƒ"]},l={"Ù…Ù…ØªØ§Ø²Ø©":{discount:.2,description:"Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ø­Ø§Ù„Ø© Ù…Ù…ØªØ§Ø²Ø©ØŒ Ø´Ø¨Ù‡ Ø¬Ø¯ÙŠØ¯"},"Ø¬ÙŠØ¯Ø© Ø¬Ø¯Ø§Ù‹":{discount:.35,description:"Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ø­Ø§Ù„Ø© Ø¬ÙŠØ¯Ø© Ø¬Ø¯Ø§Ù‹ Ù…Ø¹ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®ÙÙŠÙ"},"Ø¬ÙŠØ¯Ø©":{discount:.5,description:"Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ø­Ø§Ù„Ø© Ø¬ÙŠØ¯Ø© Ù…Ø¹ Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ§Ø¶Ø­Ø©"},"Ù…ØªÙˆØ³Ø·Ø©":{discount:.65,description:"Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ø­Ø§Ù„Ø© Ù…ØªÙˆØ³Ø·Ø© Ù…Ø¹ Ø¨Ø¹Ø¶ Ø§Ù„Ø¹ÙŠÙˆØ¨"},"Ù…Ù‚Ø¨ÙˆÙ„Ø©":{discount:.75,description:"Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ø­Ø§Ù„Ø© Ù…Ù‚Ø¨ÙˆÙ„Ø© Ù…Ø¹ Ø¹ÙŠÙˆØ¨ ÙˆØ§Ø¶Ø­Ø©"}};let d=null;for(const[n,r]of Object.entries(i)){for(const t of r)if(e.includes(t)){d=a({name:n},l[n]);break}if(d)break}if(!d){const e={furniture:"Ø¬ÙŠØ¯Ø© Ø¬Ø¯Ø§Ù‹",books:"Ø¬ÙŠØ¯Ø©",clothes:"Ù…ØªÙˆØ³Ø·Ø©",toys:"Ø¬ÙŠØ¯Ø©",other:"Ø¬ÙŠØ¯Ø©"}[n]||"Ø¬ÙŠØ¯Ø©";d=a({name:e},l[e])}let c=Math.round(t*(1-d.discount));const p={furniture:1,books:.7,clothes:.6,toys:.7,other:.8}[n]||.8;c=Math.round(c*p);const x=Math.min(c,500),u=Math.round((t-x)/t*100),g={furniture:!0,toys:!0,other:!0,clothes:!1,books:!1}[n]||!1,h=g?((e,t,i)=>{const n=(t+" "+i).toLowerCase(),r={"ÙƒØ±Ø³ÙŠ|chair|seat":"ÙŠÙ…ÙƒÙ† ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ Ø­Ø§Ù…Ù„ Ù†Ø¨Ø§ØªØ§Øª Ø£Ùˆ ÙƒØ±Ø³ÙŠ Ø¯ÙŠÙƒÙˆØ± Ø¨Ø¹Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø·Ù„Ø§Ø¡","Ø·Ø§ÙˆÙ„Ø©|table|desk":"ÙŠÙ…ÙƒÙ† ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ø¥Ù„Ù‰ Ø±Ù Ø­Ø§Ø¦Ø· Ø£Ùˆ Ø·Ø§ÙˆÙ„Ø© Ø¬Ø§Ù†Ø¨ÙŠØ© Ø¹ØµØ±ÙŠØ©","Ø¯ÙˆÙ„Ø§Ø¨|Ø®Ø²Ø§Ù†Ø©|wardrobe|cabinet":"ÙŠÙ…ÙƒÙ† ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ Ù…ÙƒØªØ¨Ø© ÙƒØªØ¨ Ø£Ùˆ ÙˆØ­Ø¯Ø© ØªØ®Ø²ÙŠÙ† Ù„Ù„Ø£Ø¯ÙˆØ§Øª","Ø³Ø±ÙŠØ±|bed|mattress":"ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¥Ø·Ø§Ø± ÙƒÙ‚Ø§Ø¹Ø¯Ø© Ù„Ø£Ø±ÙŠÙƒØ© Ø£Ùˆ ØµÙˆÙØ§","Ø±Ù|shelf":"ÙŠÙ…ÙƒÙ† Ø¥Ø¹Ø§Ø¯Ø© Ø·Ù„Ø§Ø¦Ù‡ ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙƒØ¯ÙŠÙƒÙˆØ± Ø­Ø§Ø¦Ø· Ø£Ùˆ Ù…Ù†Ø¸Ù…","Ù…Ø±Ø¢Ø©|mirror":"ÙŠÙ…ÙƒÙ† ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„Ø¥Ø·Ø§Ø± ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙƒÙ‚Ø·Ø¹Ø© Ø¯ÙŠÙƒÙˆØ± ÙÙ†ÙŠØ©","Ø³Ø¬Ø§Ø¯Ø©|carpet|rug":"ÙŠÙ…ÙƒÙ† Ù‚ØµÙ‡Ø§ ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙƒÙ…Ù…Ø³Ø­Ø© Ø£Ùˆ ÙØ±Ø´ ØµØºÙŠØ±","Ø¯Ù…ÙŠØ©|Ø¯Ø¨Ø¯ÙˆØ¨|teddy|doll":"ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙƒØ¯ÙŠÙƒÙˆØ± Ù„ØºØ±ÙØ© Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø£Ùˆ Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ù‡Ø§","Ù„Ø¹Ø¨Ø©|toy|game":"ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ù‡Ø§ Ù„Ø¯ÙˆØ± Ø§Ù„Ø£ÙŠØªØ§Ù… Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙÙŠ Ø§Ù„Ø­Ø¶Ø§Ù†Ø§Øª","Ø¹Ø±Ø¨ÙŠØ©|Ø³ÙŠØ§Ø±Ø© Ù„Ø¹Ø¨Ø©|car toy":"ÙŠÙ…ÙƒÙ† ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ø¥Ù„Ù‰ Ù‚Ø·Ø¹Ø© Ø¯ÙŠÙƒÙˆØ± Ø£Ùˆ Ø­Ø§Ù…Ù„ Ø£Ù‚Ù„Ø§Ù… Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ","Ø¨Ø§Ø²Ù„|puzzle":"ÙŠÙ…ÙƒÙ† ØªØ£Ø·ÙŠØ± Ø§Ù„Ù‚Ø·Ø¹ ÙˆØ¹Ù…Ù„ Ù„ÙˆØ­Ø© ÙÙ†ÙŠØ© Ù„Ù„Ø­Ø§Ø¦Ø·","ÙƒØªØ§Ø¨|book|Ù…Ø¬Ù„Ø©|magazine":"ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ù‡Ø§ Ù„Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØµÙØ­Ø§Øª ÙÙŠ Ø£Ø¹Ù…Ø§Ù„ ÙÙ†ÙŠØ©","Ù‚ØµØ©|story|Ø±ÙˆØ§ÙŠØ©|novel":"ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ù‡Ø§ Ù„Ù„Ù…Ø¯Ø§Ø±Ø³ Ø£Ùˆ Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙƒØªØ¨Ø© Ù…Ø¬Ø§Ù†ÙŠØ© ÙÙŠ Ø§Ù„Ø­ÙŠ","Ù‚Ù…ÙŠØµ|shirt|blouse":"ÙŠÙ…ÙƒÙ† ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ ÙˆØ³Ø§Ø¯Ø© Ø£Ùˆ Ø­Ù‚ÙŠØ¨Ø© Ù‚Ù…Ø§Ø´","Ø¨Ù†Ø·Ù„ÙˆÙ†|pants|jeans":"ÙŠÙ…ÙƒÙ† ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ Ø­Ù‚ÙŠØ¨Ø© Ø¬ÙŠÙ†Ø² Ø¹ØµØ±ÙŠØ© Ø£Ùˆ Ù…ÙØ±Ø´","ÙØ³ØªØ§Ù†|dress":"ÙŠÙ…ÙƒÙ† ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ Ù…Ù„Ø§Ø¨Ø³ Ù„Ù„Ø£Ø·ÙØ§Ù„ Ø£Ùˆ ÙˆØ³Ø§Ø¦Ø¯ Ø¯ÙŠÙƒÙˆØ±","Ø¬Ø§ÙƒÙŠØª|jacket|Ù…Ø¹Ø·Ù|coat":"ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ù‡ Ø£Ùˆ ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ Ø¨Ø·Ø§Ù†ÙŠØ© ØµØºÙŠØ±Ø©","ØµÙ†Ø¯ÙˆÙ‚|box|Ø¹Ù„Ø¨Ø©":"ÙŠÙ…ÙƒÙ† ØªØ²ÙŠÙŠÙ†Ù‡ ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙƒØµÙ†Ø¯ÙˆÙ‚ ØªØ®Ø²ÙŠÙ† Ø£Ù†ÙŠÙ‚","Ø¥Ø·Ø§Ø±|frame":"ÙŠÙ…ÙƒÙ† Ø¥Ø¹Ø§Ø¯Ø© Ø·Ù„Ø§Ø¦Ù‡ ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù„ØµÙˆØ± Ø£Ùˆ Ù…Ø±Ø§ÙŠØ§ Ø¬Ø¯ÙŠØ¯Ø©","Ø²Ø¬Ø§Ø¬|glass|Ø¨Ø±Ø·Ù…Ø§Ù†|jar":"ÙŠÙ…ÙƒÙ† ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ Ù…Ø²Ù‡Ø±ÙŠØ© Ø£Ùˆ Ø­Ø§Ù…Ù„ Ø´Ù…ÙˆØ¹ Ø¯ÙŠÙƒÙˆØ±ÙŠ","Ø³Ù„Ø©|basket":"ÙŠÙ…ÙƒÙ† ØªØ²ÙŠÙŠÙ†Ù‡Ø§ ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙƒÙ…Ù†Ø¸Ù… Ù„Ù„Ø£Ø¯ÙˆØ§Øª Ø£Ùˆ Ø§Ù„Ù†Ø¨Ø§ØªØ§Øª","ÙˆØ³Ø§Ø¯Ø©|pillow|cushion":"ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ± Ø§Ù„ØºØ·Ø§Ø¡ ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙƒØ¯ÙŠÙƒÙˆØ± Ø¬Ø¯ÙŠØ¯","Ø³ØªØ§Ø±Ø©|curtain":"ÙŠÙ…ÙƒÙ† ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ø¥Ù„Ù‰ ØºØ·Ø§Ø¡ Ø·Ø§ÙˆÙ„Ø© Ø£Ùˆ ÙˆØ³Ø§Ø¦Ø¯","Ø³Ø¬Ø§Ø¯Ø©|mat":"ÙŠÙ…ÙƒÙ† Ù‚ØµÙ‡Ø§ ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙƒÙ…Ù…Ø³Ø­Ø© Ø£Ùˆ ÙØ±Ø´ Ù„Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„Ø£Ù„ÙŠÙØ©"};for(const[s,l]of Object.entries(r)){const e=s.split("|");for(const t of e)if(n.includes(t))return l}const o={furniture:"ÙŠÙ…ÙƒÙ† Ø¥Ø¹Ø§Ø¯Ø© Ø·Ù„Ø§Ø¦Ù‡Ø§ ÙˆØªØ¬Ø¯ÙŠØ¯Ù‡Ø§ Ù„ØªØµØ¨Ø­ Ù‚Ø·Ø¹Ø© Ø¯ÙŠÙƒÙˆØ± Ø¹ØµØ±ÙŠØ©",toys:"ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ù‡Ø§ Ù„Ø¯ÙˆØ± Ø§Ù„Ø£ÙŠØªØ§Ù… Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙÙŠ Ø§Ù„Ø­Ø¶Ø§Ù†Ø§Øª",books:"ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ù‡Ø§ Ù„Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³",clothes:"ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ù‡Ø§ Ø£Ùˆ ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ø¥Ù„Ù‰ Ù‚Ø·Ø¹ Ù‚Ù…Ø§Ø´ÙŠØ© Ù…ÙÙŠØ¯Ø©",other:"ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙÙŠ Ù…Ø´Ø§Ø±ÙŠØ¹ DIY Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ© Ø£Ùˆ Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ù‡Ø§"};return o[e]||o.other})(n,o,s):null;return{condition:d.name,canRecycle:g,suggestedPrice:x,originalPrice:t,discountPercentage:u,recycleIdea:h,reasoning:d.description}}),createProduct:(t,i,n)=>c(e,null,function*(){try{if(!t.title||t.title.trim().length<3)throw new Error("Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù†ØªØ¬ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 3 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");if(!t.description||t.description.trim().length<10)throw new Error("ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 10 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");if(!i||0===i.length)throw new Error("ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");if(n.originalPrice>500)throw new Error("Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£ØµÙ„ÙŠ ÙŠØ¬Ø¨ Ø£Ù„Ø§ ÙŠØªØ¬Ø§ÙˆØ² 500 Ø¬Ù†ÙŠÙ‡ (Ø­Ø¯ Ø¨ÙŠÙƒÙŠØ§)");const e=new Promise((e,t)=>setTimeout(()=>t(new Error("Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø±ÙØ¹ Ø§Ù„Ù…Ù†ØªØ¬. ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª")),3e4)),r=le.from("products").insert(d(a({},t),{images:i,condition:n.condition,original_price:n.originalPrice,suggested_price:n.suggestedPrice,discount_percentage:n.discountPercentage,can_recycle:n.canRecycle,recycle_idea:n.recycleIdea,status:"pending"})).select().single(),{data:o,error:s}=yield Promise.race([r,e]);if(s){if(s.message.includes("violates foreign key"))throw new Error("Ø®Ø·Ø£ ÙÙŠ Ø±Ø¨Ø· Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ø­Ø³Ø§Ø¨Ùƒ. Ø­Ø§ÙˆÙ„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰");throw new Error(`Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬: ${s.message}`)}return o}catch(e){throw new Error(e.message||"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰")}}),approveProduct:(t,n)=>c(e,null,function*(){const{data:e,error:r}=yield le.from("products").update({status:"approved",final_price:n,approved_at:(new Date).toISOString()}).eq("id",t).select().single();if(r)throw r;return yield le.from("notifications").insert({user_id:e.user_id,product_id:t,message:`ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬Ùƒ "${e.title}" Ø¨Ø³Ø¹Ø± ${n} Ø¬Ù†ÙŠÙ‡`,type:"product_approved"}),yield i().sendLocationNotifications(e),e}),rejectProduct:(t,i)=>c(e,null,function*(){const{data:e,error:n}=yield le.from("products").update({status:"rejected",rejection_reason:i}).eq("id",t).select().single();if(n)throw n;return yield le.from("notifications").insert({user_id:e.user_id,product_id:t,message:`ØªÙ… Ø±ÙØ¶ Ù…Ù†ØªØ¬Ùƒ "${e.title}". Ø§Ù„Ø³Ø¨Ø¨: ${i}`,type:"product_rejected"}),e}),negotiateProduct:(t,i,n)=>c(e,null,function*(){const{data:e,error:r}=yield le.from("products").update({status:"awaiting_seller",negotiated_price:i,negotiation_note:n,seller_rejected_negotiation:!1}).eq("id",t).select().single();if(r)throw r;const o=n?` - ${n}`:"";return yield le.from("notifications").insert({user_id:e.user_id,product_id:t,message:`Ø¹Ø±Ø¶ Ø³Ø¹Ø± Ø¬Ø¯ÙŠØ¯ Ù„Ù…Ù†ØªØ¬Ùƒ "${e.title}": ${i} Ø¬Ù†ÙŠÙ‡${o}`,type:"price_negotiation"}),e}),acceptNegotiation:t=>c(e,null,function*(){const{data:e}=yield le.from("products").select("negotiated_price, title, user_id").eq("id",t).single(),{data:i,error:n}=yield le.from("products").update({status:"pending",final_price:e.negotiated_price,negotiation_note:"Ø§Ù„Ø¨Ø§Ø¦Ø¹ ÙˆØ§ÙÙ‚ - ÙŠØ­ØªØ§Ø¬ Ù…ÙˆØ§ÙÙ‚Ø© Ù†Ù‡Ø§Ø¦ÙŠØ© Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©"}).eq("id",t).select().single();if(n)throw n;const{data:r}=yield le.from("profiles").select("id").eq("role","admin");if(r&&r.length>0){const i=r.map(i=>({user_id:i.id,product_id:t,message:`âœ… Ø§Ù„Ø¨Ø§Ø¦Ø¹ ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¶! Ø§Ù„Ù…Ù†ØªØ¬ "${e.title}" Ø¨Ø³Ø¹Ø± ${e.negotiated_price} Ø¬Ù†ÙŠÙ‡ - ÙŠØ­ØªØ§Ø¬ Ù…ÙˆØ§ÙÙ‚ØªÙƒ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ù„Ù„Ù†Ø´Ø±`,type:"offer"}));yield le.from("notifications").insert(i)}return i}),rejectNegotiation:t=>c(e,null,function*(){const{data:e}=yield le.from("products").select("*, profiles(username, phone)").eq("id",t).single(),{data:i,error:n}=yield le.from("products").update({status:"pending",seller_rejected_negotiation:!0,negotiated_price:null,negotiation_note:"Ø§Ù„Ø¨Ø§Ø¦Ø¹ Ø±ÙØ¶ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø§Ø¨Ù‚ - ÙŠØ­ØªØ§Ø¬ ØªÙØ§ÙˆØ¶ Ø¬Ø¯ÙŠØ¯"}).eq("id",t).select().single();if(n)throw n;const{data:r}=yield le.from("profiles").select("id").eq("role","admin");if(r&&r.length>0){const i=r.map(i=>({user_id:i.id,product_id:t,message:`Ø§Ù„Ø¨Ø§Ø¦Ø¹ ${e.profiles.username} Ø±ÙØ¶ Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ÙˆØ¶ ÙˆÙŠØ­ØªØ§Ø¬ ØªÙØ§ÙˆØ¶ Ø¬Ø¯ÙŠØ¯. Ø±Ù‚Ù… Ø§Ù„ØªÙ„ÙŠÙÙˆÙ†: ${e.profiles.phone}`,type:"negotiation_rejected"}));yield le.from("notifications").insert(i)}return i}),sendLocationNotifications:t=>c(e,null,function*(){const{data:e}=yield le.from("profiles").select("location").eq("id",t.user_id).single();if(!e)return;const{data:i}=yield le.from("profiles").select("id, username").eq("location",e.location).neq("id",t.user_id);if(i&&i.length>0){const e=i.map(e=>({user_id:e.id,product_id:t.id,message:`Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ Ù…ØªØ§Ø­ ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙƒ: ${t.title}`,type:"new_product"}));yield le.from("notifications").insert(e)}}),fetchProducts:(i=null,n=1,r=20)=>c(e,null,function*(){t({loading:!0});try{const e=`products_${i||"all"}_page_${n}`,o=ye.get(e);if(o)return t({products:o.data,loading:!1,totalPages:o.totalPages,currentPage:n,totalItems:o.count}),o;const s=new Promise((e,t)=>setTimeout(()=>t(new Error("timeout")),2e4));let l=le.from("products").select("*, profiles!products_user_id_fkey(username, location)",{count:"exact"}).eq("status","approved").order("created_at",{ascending:!1}).range((n-1)*r,n*r-1);i&&(l=l.eq("profiles.location",i));const c=l,{data:p,error:x,count:u}=yield Promise.race([c,s]);if(x)throw t({loading:!1}),new Error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª. ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª");const{data:g}=yield le.from("profiles").select("username, location, phone, email").eq("role","admin").limit(1).single(),h=(p||[]).map(e=>d(a({},e),{profiles:g||e.profiles})),f={data:h,count:u,totalPages:Math.ceil(u/r)};return ye.set(e,f),t({products:h,loading:!1,totalPages:Math.ceil(u/r),currentPage:n,totalItems:u}),f}catch(e){if(t({loading:!1}),"timeout"===e.message)throw new Error("Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„. ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰");throw new Error(e.message||"Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª")}}),fetchUserProducts:t=>c(e,null,function*(){const e=`user_products_${t}`,i=ye.get(e);if(i)return i;const n=new AbortController,r=setTimeout(()=>n.abort(),3e4);try{const{data:i,error:n}=yield le.from("products").select("*").eq("user_id",t).order("created_at",{ascending:!1});if(clearTimeout(r),n)throw n;const o=i;return ye.set(e,o,18e4),o}catch(o){if("AbortError"===o.name||o.message.includes("timeout"))throw new Error("Request timed out. Please try again.");throw o}}),fetchPendingProducts:()=>c(e,null,function*(){try{const{data:e,error:t}=yield le.from("products").select("*, profiles(username, email, phone, location)").eq("status","pending").order("created_at",{ascending:!1});if(null==e||e.length,t)throw t;return e||[]}catch(e){return function(e){e&&e.name}(e),[]}})}));function je({images:e,initialIndex:t=0,onClose:i}){const[n,r]=p.useState(t),o=()=>{r(t=>(t+1)%e.length)},s=()=>{r(t=>(t-1+e.length)%e.length)};return k.jsxs("div",{style:ve.overlay,onClick:i,onKeyDown:e=>{"Escape"===e.key&&i(),"ArrowRight"===e.key&&s(),"ArrowLeft"===e.key&&o()},tabIndex:0,children:[k.jsx("button",{className:"lightbox-close-btn",style:ve.closeBtn,onClick:i,children:"âœ•"}),k.jsxs("div",{style:ve.content,onClick:e=>e.stopPropagation(),children:[k.jsx("img",{src:e[n],alt:`ØµÙˆØ±Ø© ${n+1}`,style:ve.image,className:"lightbox-image",onError:e=>{e.target.src="https://placehold.co/600x400/e2e8f0/64748b?text=Image+Load+Failed"}}),e.length>1&&k.jsxs(k.Fragment,{children:[k.jsx("button",{className:"lightbox-nav-btn",style:a(a({},ve.navBtn),ve.prevBtn),onClick:s,children:"â®"}),k.jsx("button",{className:"lightbox-nav-btn",style:a(a({},ve.navBtn),ve.nextBtn),onClick:o,children:"â¯"}),k.jsxs("div",{className:"lightbox-counter",style:ve.counter,children:[n+1," / ",e.length]})]})]})]})}const ve={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"linear-gradient(135deg, rgba(0, 0, 0, 0.95) 0%, rgba(10, 14, 39, 0.98) 100%)",backdropFilter:"blur(20px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:9999,cursor:"pointer",animation:"fadeIn 0.4s ease",padding:"20px"},content:{position:"relative",maxWidth:"95vw",maxHeight:"95vh",cursor:"default",animation:"zoomIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)",display:"flex",alignItems:"center",justifyContent:"center"},image:{maxWidth:"100%",maxHeight:"90vh",width:"auto",height:"auto",objectFit:"contain",borderRadius:"20px",boxShadow:"0 30px 90px rgba(0, 0, 0, 0.8), 0 0 60px rgba(107, 124, 89, 0.3)",border:"3px solid rgba(107, 124, 89, 0.3)",transition:"transform 0.3s ease"},closeBtn:{position:"fixed",top:"30px",right:"30px",background:"linear-gradient(135deg, rgba(107, 124, 89, 0.9) 0%, rgba(85, 107, 47, 0.9) 100%)",border:"none",borderRadius:"50%",width:"56px",height:"56px",fontSize:"28px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,transition:"all 0.3s ease",boxShadow:"0 8px 25px rgba(107, 124, 89, 0.5)",fontWeight:"300"},navBtn:{position:"absolute",top:"50%",transform:"translateY(-50%)",background:"linear-gradient(135deg, rgba(107, 124, 89, 0.9) 0%, rgba(85, 107, 47, 0.9) 100%)",border:"none",borderRadius:"50%",width:"64px",height:"64px",fontSize:"32px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease",boxShadow:"0 8px 25px rgba(107, 124, 89, 0.5)",fontWeight:"700",zIndex:10001},prevBtn:{right:"-80px"},nextBtn:{left:"-80px"},counter:{position:"fixed",bottom:"40px",left:"50%",transform:"translateX(-50%)",background:"linear-gradient(135deg, rgba(107, 124, 89, 0.95) 0%, rgba(85, 107, 47, 0.95) 100%)",backdropFilter:"blur(10px)",padding:"12px 32px",borderRadius:"30px",fontSize:"16px",fontWeight:"700",color:"white",boxShadow:"0 8px 25px rgba(107, 124, 89, 0.5)",border:"2px solid rgba(107, 124, 89, 0.3)",zIndex:1e4}};function we({product:e,isAdmin:t,onDelete:i}){var n,r;const[o,s]=p.useState(!1),l=h();return k.jsxs(k.Fragment,{children:[k.jsxs("div",{className:"card netflix-spotlight netflix-lift",style:Se.card,onClick:()=>{l(`/product/${e.id}`)},children:[k.jsxs("div",{style:Se.imageContainer,onClick:e=>{e.stopPropagation(),s(!0)},children:[k.jsx("img",{src:e.images[0],alt:e.title,style:Se.image,loading:"lazy",onError:e=>{e.target.src="https://placehold.co/300x200/e2e8f0/64748b?text=Image+Not+Found"}}),e.images.length>1&&k.jsxs("div",{style:Se.imageCount,className:"netflix-badge",children:["ðŸ“· ",e.images.length]}),e.active_offer&&k.jsxs("div",{style:Se.offerOverlay,className:"netflix-badge",children:["ðŸ”¥ Ø®ØµÙ… ",e.active_offer.discount_percentage,"%"]})]}),k.jsxs("div",{style:Se.content,children:[k.jsx("h3",{style:Se.title,children:e.title}),k.jsx("p",{style:Se.description,children:e.description}),t&&k.jsx("button",{onClick:t=>{t.stopPropagation(),i&&i(e.id)},style:Se.deleteButton,className:"btn",children:"ðŸ—‘ï¸ Ø­Ø°Ù"}),k.jsxs("div",{style:Se.details,children:[k.jsx("div",{style:Se.priceContainer,children:e.active_offer?k.jsxs(k.Fragment,{children:[k.jsxs("div",{style:Se.offerBadge,children:["ðŸŽ‰ Ø®ØµÙ… ",e.active_offer.discount_percentage,"%"]}),k.jsxs("div",{style:Se.priceWithDiscount,children:[k.jsxs("span",{style:Se.oldPrice,children:[e.original_final_price," Ø¬Ù†ÙŠÙ‡"]}),k.jsxs("span",{style:Se.newPrice,children:[e.final_price," Ø¬Ù†ÙŠÙ‡"]})]})]}):k.jsxs("span",{style:Se.price,children:[e.final_price," Ø¬Ù†ÙŠÙ‡"]})}),k.jsx("span",{style:Se.condition,children:e.condition})]}),k.jsxs("div",{style:Se.seller,children:[k.jsxs("span",{children:["Ø§Ù„Ø¨Ø§Ø¦Ø¹: ",null==(n=e.profiles)?void 0:n.username]}),k.jsxs("span",{children:["ðŸ“ ",null==(r=e.profiles)?void 0:r.location]})]})]})]}),o&&k.jsx(je,{images:e.images,onClose:()=>s(!1)})]})}const Se={card:{overflow:"hidden",transition:"all 0.5s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer",animation:"fadeInUp 0.6s ease-out",position:"relative"},imageContainer:{width:"100%",height:"320px",overflow:"hidden",background:"linear-gradient(135deg, #1a1f2e 0%, #2d3748 100%)",position:"relative",cursor:"pointer"},image:{width:"100%",height:"100%",objectFit:"cover",transition:"all 0.6s cubic-bezier(0.4, 0, 0.2, 1)",filter:"brightness(0.9) contrast(1.1) saturate(1.2)"},imageCount:{position:"absolute",top:"16px",right:"16px",zIndex:2},offerOverlay:{position:"absolute",top:"16px",left:"16px",zIndex:2,animation:"badge-pulse 2s ease-in-out infinite"},content:{padding:"32px",position:"relative",zIndex:1},title:{fontSize:"24px",fontWeight:"800",marginBottom:"14px",color:"#f9fafb",lineHeight:"1.3",letterSpacing:"-0.5px",textShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},description:{color:"#d1d5db",fontSize:"15px",marginBottom:"24px",lineHeight:"1.7",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},details:{display:"flex",flexDirection:"column",gap:"16px",marginBottom:"24px"},priceContainer:{display:"flex",flexDirection:"column",gap:"12px"},offerBadge:{background:"linear-gradient(135deg, #8b7355 0%, #6d5a42 100%)",color:"white",padding:"8px 16px",borderRadius:"20px",fontSize:"13px",fontWeight:"700",alignSelf:"flex-start",boxShadow:"0 4px 12px rgba(139, 115, 85, 0.4), 0 0 20px rgba(139, 115, 85, 0.2)",animation:"pulse 2s ease-in-out infinite",textTransform:"uppercase",letterSpacing:"0.5px"},priceWithDiscount:{display:"flex",alignItems:"center",gap:"14px"},oldPrice:{fontSize:"18px",color:"#6b7280",textDecoration:"line-through",fontWeight:"500"},newPrice:{fontSize:"32px",fontWeight:"900",background:"linear-gradient(135deg, #6b7c59 0%, #8b7355 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",letterSpacing:"-1px",textShadow:"0 0 20px rgba(107, 124, 89, 0.5)"},price:{fontSize:"30px",fontWeight:"900",background:"linear-gradient(135deg, #6b7c59 0%, #8b7355 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",letterSpacing:"-1px"},condition:{background:"rgba(107, 124, 89, 0.2)",color:"#a7f3d0",padding:"8px 18px",borderRadius:"20px",fontSize:"13px",fontWeight:"700",alignSelf:"flex-start",border:"1px solid rgba(107, 124, 89, 0.3)",boxShadow:"0 2px 8px rgba(107, 124, 89, 0.2)",textTransform:"uppercase",letterSpacing:"0.5px"},seller:{display:"flex",justifyContent:"space-between",fontSize:"13px",color:"#9ca3af",paddingTop:"24px",borderTop:"2px solid rgba(107, 124, 89, 0.15)",fontWeight:"600"},deleteButton:{background:"#dc2626",color:"white",border:"none",padding:"10px 20px",borderRadius:"20px",fontSize:"14px",fontWeight:"600",cursor:"pointer",marginBottom:"16px",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(220, 38, 38, 0.4)"}};function _e(){const e=h(),[t,i]=p.useState([]),[n,r]=p.useState(0),[o,s]=p.useState(0),[l,a]=p.useState(0),[d,x]=p.useState({}),{fetchProducts:u}=be(),{profile:g}=ae();p.useEffect(()=>{m(),f()},[]);const f=()=>c(this,null,function*(){try{const{count:e,error:t}=yield le.from("products").select("*",{count:"exact",head:!0}).eq("status","approved").or("choice_type.is.null,choice_type.eq.sell");if(t)throw t;r(e||0);const{count:i,error:n}=yield le.from("products").select("*",{count:"exact",head:!0}).eq("status","sold");if(n)throw n;s(i||0),a("4.8");const{data:o,error:l}=yield le.from("products").select("category").eq("status","approved").or("choice_type.is.null,choice_type.eq.sell");if(!l&&o){const e={};o.forEach(t=>{const i=t.category||"Ø£Ø®Ø±Ù‰";e[i]=(e[i]||0)+1}),x(e)}}catch(e){}}),m=()=>c(this,null,function*(){try{let e=le.from("offers").select("*").eq("is_active",!0).order("created_at",{ascending:!1});const{data:t,error:n}=yield e;if(n)throw n;const r=(null==t?void 0:t.filter(e=>!e.target_location||e.target_location===(null==g?void 0:g.location)))||[];i(r)}catch(e){}});return k.jsxs("div",{className:"container",children:[k.jsxs("div",{className:"netflix-hero",style:Ce.heroSection,children:[k.jsxs("div",{style:Ce.heroContent,children:[k.jsx("h1",{style:Ce.heroTitle,className:"netflix-shimmer",children:"Ø¨ÙŠÙƒÙŠØ§"}),k.jsx("p",{style:Ce.heroSubtitle,children:"Ø§Ù„Ø­Ø§Ø¬Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ù„Ø³Ù‡ Ù„ÙŠÙ‡Ø§ Ù‚ÙŠÙ…Ø©"}),k.jsx("p",{style:Ce.heroDescription,children:"Ø§ÙƒØªØ´Ù Ø£ÙØ¶Ù„ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø³ØªØ¹Ù…Ù„Ø© Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©"}),k.jsxs("div",{style:Ce.heroButtons,children:[k.jsx("button",{className:"morph-button",onClick:()=>e("/add-product"),children:"Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø¢Ù†"}),k.jsx("button",{className:"morph-button",style:{background:"linear-gradient(135deg, #8b7355 0%, #6d5a42 100%)"},onClick:()=>e("/browse"),children:"ØªØµÙØ­ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª"})]})]}),k.jsxs("div",{style:Ce.statsRow,children:[k.jsxs("div",{className:"stats-card",style:Ce.statCard,children:[k.jsx("svg",{style:{width:"48px",height:"48px",margin:"0 auto 16px"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:k.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})}),k.jsx("div",{className:"stats-number",children:l}),k.jsx("div",{className:"stats-label",children:"ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡"})]}),k.jsxs("div",{className:"stats-card",style:Ce.statCard,children:[k.jsxs("svg",{style:{width:"48px",height:"48px",margin:"0 auto 16px"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[k.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),k.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),k.jsxs("div",{className:"stats-number",children:["+",o]}),k.jsx("div",{className:"stats-label",children:"Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹"})]}),k.jsxs("div",{className:"stats-card",style:Ce.statCard,children:[k.jsx("svg",{style:{width:"48px",height:"48px",margin:"0 auto 16px"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:k.jsx("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"})}),k.jsxs("div",{className:"stats-number",children:["+",n]}),k.jsx("div",{className:"stats-label",children:"Ù…Ù†ØªØ¬ Ù…ØªØ§Ø­"})]})]})]}),k.jsx("div",{className:"glow-divider"}),k.jsxs("div",{style:Ce.categoriesSection,children:[k.jsx("h2",{style:Ce.sectionTitle,children:"ÙØ¦Ø§ØªÙ†Ø§ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©"}),k.jsx("div",{style:Ce.categoriesGrid,children:[{name:"Ø£Ø«Ø§Ø«",key:"Ø£Ø«Ø§Ø«"},{name:"Ù…Ù„Ø§Ø¨Ø³",key:"Ù…Ù„Ø§Ø¨Ø³"},{name:"ÙƒØªØ¨",key:"ÙƒØªØ¨"},{name:"Ø£Ù„Ø¹Ø§Ø¨",key:"Ø£Ù„Ø¹Ø§Ø¨"},{name:"Ø£Ø¬Ù‡Ø²Ø© Ù…Ù†Ø²Ù„ÙŠØ©",key:"Ø£Ø¬Ù‡Ø²Ø© Ù…Ù†Ø²Ù„ÙŠØ©"}].map((e,t)=>k.jsxs("div",{className:"stats-card netflix-lift",style:Ce.categoryCard,children:[k.jsx("h3",{style:Ce.categoryName,children:e.name}),k.jsxs("p",{style:Ce.categoryCount,children:[d[e.key]||0," Ù…Ù†ØªØ¬"]})]},t))})]}),k.jsx("div",{className:"glow-divider"}),t.length>0&&k.jsxs("div",{style:Ce.offersSection,children:[k.jsx("h2",{style:Ce.offersTitle,children:"Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø­Ø§Ù„ÙŠØ©"}),k.jsx("div",{style:Ce.offersGrid,children:t.map(e=>k.jsxs("div",{className:"card netflix-spotlight netflix-lift",style:Ce.offerCard,children:[e.image&&k.jsx("img",{src:e.image,alt:e.title,style:Ce.offerImage}),k.jsxs("div",{style:Ce.offerContent,children:[k.jsx("h3",{style:Ce.offerTitle,children:e.title}),k.jsx("p",{style:Ce.offerDesc,children:e.description}),e.discount_percentage&&k.jsxs("div",{style:Ce.discountBadge,className:"netflix-badge",children:["Ø®ØµÙ… ",e.discount_percentage,"%"]}),e.end_date&&k.jsxs("p",{style:Ce.offerDate,children:["ÙŠÙ†ØªÙ‡ÙŠ: ",new Date(e.end_date).toLocaleDateString("ar-EG")]})]})]},e.id))})]}),k.jsx("div",{className:"glow-divider"}),k.jsxs("div",{style:Ce.howItWorksSection,children:[k.jsx("h2",{style:Ce.sectionTitle,children:"ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø¨ÙŠÙƒÙŠØ§ØŸ"}),k.jsx("div",{style:Ce.stepsGrid,children:[{title:"ØµÙˆØ± Ù…Ù†ØªØ¬Ùƒ",desc:"Ø§Ù„ØªÙ‚Ø· ØµÙˆØ± ÙˆØ§Ø¶Ø­Ø© Ù„Ù„Ù…Ù†ØªØ¬"},{title:"Ø­Ø¯Ø¯ Ø§Ù„Ø³Ø¹Ø±",desc:"Ø§Ù„Ø³Ø¹Ø± ÙŠØ­Ø¯Ø¯Ù‡ Ø§Ù„Ù…Ø¯ÙŠØ±"},{title:"Ø§Ù†ØªØ¸Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©",desc:"Ø³Ù†Ø±Ø§Ø¬Ø¹ Ù…Ù†ØªØ¬Ùƒ ÙˆÙ†ÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡"},{title:"Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¨ÙŠØ¹",desc:"Ù…Ù†ØªØ¬Ùƒ Ù…ØªØ§Ø­ Ù„Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø¢Ù†!"}].map((e,t)=>k.jsxs("div",{className:"stats-card netflix-lift",style:Ce.stepCard,children:[k.jsx("div",{style:Ce.stepNumber,children:t+1}),k.jsx("h3",{style:Ce.stepTitle,children:e.title}),k.jsx("p",{style:Ce.stepDesc,children:e.desc})]},t))})]}),k.jsx("div",{style:Ce.finalCTA,children:k.jsxs("div",{className:"stats-card",style:Ce.ctaCard,children:[k.jsx("h2",{style:Ce.ctaTitle,children:"Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¨Ø¯Ø¡ØŸ"}),k.jsx("p",{style:Ce.ctaDesc,children:"Ø§Ù†Ø¶Ù… Ù„Ø¢Ù„Ø§Ù Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ† Ø§Ù„Ù†Ø§Ø¬Ø­ÙŠÙ† Ø¹Ù„Ù‰ Ø¨ÙŠÙƒÙŠØ§"}),k.jsx("button",{className:"morph-button",onClick:()=>e("/add-product"),style:{marginTop:"24px"},children:"Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø¢Ù†"})]})})]})}const Ce={heroSection:{textAlign:"center",marginBottom:"60px",padding:"60px 20px"},heroContent:{marginBottom:"48px"},heroTitle:{fontSize:"72px",marginBottom:"16px",fontWeight:"900",letterSpacing:"-2px"},heroSubtitle:{fontSize:"28px",color:"#d1d5db",fontWeight:"600",marginBottom:"16px"},heroDescription:{fontSize:"18px",color:"#9ca3af",marginBottom:"32px",maxWidth:"600px",margin:"0 auto 32px"},heroButtons:{display:"flex",gap:"20px",justifyContent:"center",flexWrap:"wrap"},statsRow:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"24px",maxWidth:"900px",margin:"0 auto"},statCard:{textAlign:"center"},categoriesSection:{marginBottom:"60px"},sectionTitle:{fontSize:"36px",color:"#f9fafb",marginBottom:"40px",fontWeight:"700",textShadow:"0 2px 10px rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center"},categoriesGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"24px"},categoryCard:{textAlign:"center",cursor:"pointer"},categoryName:{fontSize:"18px",fontWeight:"600",color:"#f9fafb",marginBottom:"8px"},categoryCount:{fontSize:"14px",color:"#9ca3af"},offersSection:{marginBottom:"60px"},offersTitle:{fontSize:"36px",color:"#f9fafb",marginBottom:"40px",fontWeight:"700",textShadow:"0 2px 10px rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center"},offersGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:"32px"},offerCard:{overflow:"hidden"},offerImage:{width:"100%",height:"260px",objectFit:"cover"},offerContent:{padding:"32px"},offerTitle:{fontSize:"24px",fontWeight:"700",color:"#f9fafb",marginBottom:"12px"},offerDesc:{color:"#d1d5db",marginBottom:"20px",lineHeight:"1.7"},discountBadge:{display:"inline-block",marginBottom:"12px"},offerDate:{fontSize:"13px",color:"#9ca3af"},howItWorksSection:{marginBottom:"60px"},stepsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"32px"},stepCard:{textAlign:"center",position:"relative"},stepNumber:{position:"absolute",top:"20px",right:"20px",width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(135deg, #6b7c59 0%, #556b2f 100%)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",fontWeight:"700",boxShadow:"0 4px 15px rgba(107, 124, 89, 0.4)"},stepTitle:{fontSize:"20px",fontWeight:"700",color:"#f9fafb",marginBottom:"12px"},stepDesc:{fontSize:"15px",color:"#d1d5db",lineHeight:"1.6"},finalCTA:{marginTop:"80px",marginBottom:"60px"},ctaCard:{textAlign:"center",padding:"60px 40px",maxWidth:"600px",margin:"0 auto"},ctaTitle:{fontSize:"36px",fontWeight:"800",color:"#f9fafb",marginBottom:"16px"},ctaDesc:{fontSize:"18px",color:"#d1d5db",lineHeight:"1.6"}};if("undefined"!=typeof document){const e=document.createElement("style");e.textContent="\n  @media (max-width: 768px) {\n    .netflix-hero {\n      padding: 40px 16px !important;\n    }\n    \n    .netflix-hero h1 {\n      font-size: 48px !important;\n    }\n    \n    .netflix-hero p {\n      font-size: 16px !important;\n    }\n    \n    .morph-button {\n      width: 100%;\n      margin-bottom: 12px;\n    }\n    \n    .stats-card {\n      padding: 20px !important;\n    }\n    \n    .icon-3d {\n      width: 48px !important;\n      height: 48px !important;\n      font-size: 24px !important;\n    }\n    \n    .stats-number {\n      font-size: 32px !important;\n    }\n    \n    .category-card {\n      padding: 20px !important;\n    }\n    \n    .offer-card {\n      margin-bottom: 16px;\n    }\n    \n    .step-card {\n      padding: 24px !important;\n    }\n  }\n  \n  @media (max-width: 480px) {\n    .netflix-hero h1 {\n      font-size: 36px !important;\n    }\n    \n    .netflix-hero p {\n      font-size: 14px !important;\n    }\n    \n    .stats-number {\n      font-size: 28px !important;\n    }\n    \n    .sectionTitle {\n      font-size: 24px !important;\n    }\n  }\n",document.head.appendChild(e)}if("undefined"!=typeof document){const e=document.createElement("style");e.textContent="\n  @keyframes skeleton-pulse {\n    0%, 100% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.5;\n    }\n  }\n  \n  @keyframes skeleton-shimmer {\n    0% {\n      background-position: -200% 0;\n    }\n    100% {\n      background-position: 200% 0;\n    }\n  }\n",document.head.appendChild(e)}function ke(){const[e,t]=p.useState([]),[i,n]=p.useState([]),[r,o]=p.useState("all"),[s,l]=p.useState(!1),[x,u]=p.useState(1),[g,h]=p.useState(1),[f,m]=p.useState(0),[y,b]=p.useState(""),{fetchProducts:j}=be(),{profile:v}=ae(),w=e=>c(this,null,function*(){if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡."))try{const{error:i}=yield le.from("products").delete().eq("id",e);if(i)throw i;t(t=>t.filter(t=>t.id!==e)),alert("ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­")}catch(i){alert("Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬: "+i.message)}});p.useEffect(()=>{C();const e=le.channel("products-changes").on("postgres_changes",{event:"*",schema:"public",table:"products",filter:"status=eq.approved"},e=>{S(x)}).subscribe(),t=e=>{s&&!e.target.closest(".dropdown-container")&&l(!1)};return document.addEventListener("mousedown",t),()=>{le.removeChannel(e),document.removeEventListener("mousedown",t)}},[s,x]),p.useEffect(()=>{i.length>=0&&S(x)},[i,x,y]);const S=(e=1)=>c(this,null,function*(){try{const n=yield j(null==v?void 0:v.location,e,20);let r=n.data.filter(e=>!e.choice_type||"sell"===e.choice_type);if(y.trim()){const e=y.toLowerCase();r=r.filter(t=>{var i,n,r;return(null==(i=t.title)?void 0:i.toLowerCase().includes(e))||(null==(n=t.description)?void 0:n.toLowerCase().includes(e))||(null==(r=t.category)?void 0:r.toLowerCase().includes(e))})}const o=r.map(e=>{const t=i.find(t=>t.is_active&&t.discount_percentage&&t.category===e.category&&(!t.end_date||new Date(t.end_date)>new Date));if(t){const i=Math.round(e.final_price*(t.discount_percentage/100));return d(a({},e),{original_final_price:e.final_price,final_price:e.final_price-i,active_offer:t})}return e});t(o),h(n.totalPages||1),m(n.count||0)}catch(n){}}),_=e=>{e>=1&&e<=g&&u(e)},C=()=>c(this,null,function*(){try{let e=le.from("offers").select("*").eq("is_active",!0).order("created_at",{ascending:!1});const{data:t,error:i}=yield e;if(i)throw i;const r=(null==t?void 0:t.filter(e=>!e.target_location||e.target_location===(null==v?void 0:v.location)))||[];n(r)}catch(e){}}),N=[{id:"all",name:"Ø§Ù„ÙƒÙ„"},{id:"furniture",name:"Ø£Ø«Ø§Ø«"},{id:"clothes",name:"Ù…Ù„Ø§Ø¨Ø³"},{id:"books",name:"ÙƒØªØ¨"},{id:"games",name:"Ø£Ù„Ø¹Ø§Ø¨"},{id:"home",name:"Ø£Ø¬Ù‡Ø²Ø© Ù…Ù†Ø²Ù„ÙŠØ©"}],B=N.find(e=>e.id===r)||N[0],z="all"===r?e:e.filter(e=>e.category===r);return k.jsxs("div",{className:"container",children:[k.jsxs("div",{style:Ne.header,children:[k.jsx("div",{style:Ne.titleContainer,children:k.jsx("h1",{style:Ne.title,children:"ØªØµÙØ­ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª"})}),k.jsx("p",{style:Ne.subtitle,children:"Ø§ÙƒØªØ´Ù Ø£ÙØ¶Ù„ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø³ØªØ¹Ù…Ù„Ø©"})]}),k.jsx("div",{style:Ne.searchContainer,children:k.jsxs("div",{style:Ne.searchBox,children:[k.jsxs("svg",{style:Ne.searchIcon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[k.jsx("circle",{cx:"11",cy:"11",r:"8"}),k.jsx("path",{d:"m21 21-4.35-4.35"})]}),k.jsx("input",{type:"text",placeholder:"Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬...",value:y,onChange:e=>b(e.target.value),style:Ne.searchInput,className:"input"}),y&&k.jsx("button",{onClick:()=>b(""),style:Ne.clearButton,children:"âœ•"})]})}),k.jsx("div",{style:Ne.categoriesBar,children:k.jsxs("div",{style:Ne.dropdownContainer,className:"dropdown-container",children:[k.jsxs("button",{className:"morph-button",style:Ne.dropdownButton,onClick:()=>l(!s),children:[k.jsx("span",{style:{fontSize:"18px",fontWeight:"700"},children:B.name}),k.jsx("span",{style:{fontSize:"20px",marginRight:"12px",transition:"transform 0.3s ease",transform:s?"rotate(180deg)":"rotate(0deg)"},children:"â–¼"})]}),s&&k.jsx("div",{style:Ne.dropdownMenu,className:"card",children:N.map(e=>k.jsxs("button",{className:"dropdown-item",style:d(a({},Ne.dropdownItem),{background:r===e.id?"rgba(107, 124, 89, 0.3)":"transparent"}),onClick:()=>{o(e.id),l(!1)},children:[k.jsx("span",{style:{fontSize:"16px",fontWeight:"600"},children:e.name}),r===e.id&&k.jsx("span",{style:{marginRight:"auto",color:"#6b7c59",fontSize:"18px"},children:"âœ“"})]},e.id))})]})}),k.jsx("div",{style:Ne.productsInfo,children:k.jsxs("p",{style:Ne.count,children:[f," Ù…Ù†ØªØ¬ Ù…ØªØ§Ø­ - Ø§Ù„ØµÙØ­Ø© ",x," Ù…Ù† ",g]})}),0===z.length?k.jsxs("div",{style:Ne.empty,children:[k.jsx("h3",{style:Ne.emptyTitle,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª"}),k.jsx("p",{style:Ne.emptyText,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØ¦Ø© Ø­Ø§Ù„ÙŠØ§Ù‹"})]}):k.jsxs(k.Fragment,{children:[k.jsx("div",{style:Ne.grid,children:z.map(e=>k.jsx(we,{product:e,isAdmin:"admin"===(null==v?void 0:v.role),onDelete:w},e.id))}),g>1&&k.jsxs("div",{style:Ne.pagination,children:[k.jsx("button",{className:"btn btn-secondary",onClick:()=>_(x-1),disabled:1===x,style:a(a({},Ne.pageButton),1===x?Ne.disabledButton:{}),children:"Ø§Ù„Ø³Ø§Ø¨Ù‚"}),k.jsx("div",{style:Ne.pageNumbers,children:[...Array(g)].map((e,t)=>{const i=t+1;return 1===i||i===g||i>=x-1&&i<=x+1?k.jsx("button",{className:"btn",onClick:()=>_(i),style:a(a({},Ne.pageNumber),x===i?Ne.activePage:{}),children:i},i):i===x-2||i===x+2?k.jsx("span",{style:Ne.ellipsis,children:"..."},i):null})}),k.jsx("button",{className:"btn btn-secondary",onClick:()=>_(x+1),disabled:x===g,style:a(a({},Ne.pageButton),x===g?Ne.disabledButton:{}),children:"Ø§Ù„ØªØ§Ù„ÙŠ"})]})]})]})}const Ne={header:{textAlign:"center",marginBottom:"48px",padding:"40px 20px"},titleContainer:{display:"flex",alignItems:"center",justifyContent:"center",gap:"20px",marginBottom:"16px",flexWrap:"wrap"},title:{fontSize:"48px",fontWeight:"900",color:"#f9fafb",margin:0,textShadow:"0 4px 20px rgba(0, 0, 0, 0.5)",letterSpacing:"-1px"},subtitle:{fontSize:"18px",color:"#d1d5db"},searchContainer:{display:"flex",justifyContent:"center",marginBottom:"32px",padding:"0 20px"},searchBox:{position:"relative",width:"100%",maxWidth:"600px"},searchIcon:{position:"absolute",right:"20px",top:"50%",transform:"translateY(-50%)",fontSize:"20px",pointerEvents:"none",zIndex:1},searchInput:{width:"100%",padding:"16px 60px 16px 60px",fontSize:"16px",borderRadius:"50px",border:"2px solid rgba(107, 124, 89, 0.3)",background:"rgba(45, 45, 45, 0.6)",color:"#f9fafb",transition:"all 0.3s ease",outline:"none"},clearButton:{position:"absolute",left:"20px",top:"50%",transform:"translateY(-50%)",background:"rgba(107, 124, 89, 0.3)",border:"none",borderRadius:"50%",width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#f9fafb",fontSize:"16px",transition:"all 0.3s ease"},categoriesBar:{display:"flex",justifyContent:"center",marginBottom:"40px",padding:"0 20px"},dropdownContainer:{position:"relative",width:"100%",maxWidth:"400px"},dropdownButton:{width:"100%",padding:"16px 24px",background:"linear-gradient(135deg, #6b7c59 0%, #556b2f 100%)",border:"none",borderRadius:"50px",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 8px 25px rgba(107, 124, 89, 0.4)"},dropdownMenu:{position:"absolute",top:"70px",left:0,right:0,zIndex:1e3,maxHeight:"400px",overflowY:"auto",borderRadius:"20px",animation:"dropdown-fade-in 0.3s ease"},dropdownItem:{width:"100%",padding:"16px 24px",background:"transparent",border:"none",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",fontSize:"16px",color:"#f9fafb",textAlign:"right",borderBottom:"1px solid rgba(107, 124, 89, 0.1)"},productsInfo:{textAlign:"center",marginBottom:"32px"},count:{fontSize:"16px",color:"#9ca3af",fontWeight:"600"},empty:{textAlign:"center",padding:"80px 20px",color:"#9ca3af"},emptyTitle:{fontSize:"24px",color:"#d1d5db",marginBottom:"12px"},emptyText:{fontSize:"16px",color:"#9ca3af"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:"40px",marginBottom:"60px"},pagination:{display:"flex",justifyContent:"center",alignItems:"center",gap:"16px",marginTop:"40px",padding:"20px",flexWrap:"wrap"},pageButton:{minWidth:"120px",padding:"12px 24px"},disabledButton:{opacity:.5,cursor:"not-allowed"},pageNumbers:{display:"flex",gap:"8px",alignItems:"center",flexWrap:"wrap"},pageNumber:{minWidth:"40px",padding:"8px 12px",borderRadius:"8px"},activePage:{background:"linear-gradient(135deg, #6b7c59 0%, #556b2f 100%)",color:"white"},ellipsis:{padding:"8px",color:"#9ca3af"}};function Be(){const[e,t]=p.useState({title:"",description:"",category:"",weight:""}),[i,n]=p.useState([]),[r,o]=p.useState([]),[s,l]=p.useState(!1),[x,u]=p.useState(0),[g,f]=p.useState(""),[m,y]=p.useState(!1),[b,j]=p.useState(0),v=p.useRef(null),[w,S]=p.useState(!1),{user:_}=ae(),C=h(),N=e=>{if(e.length+i.length>10)return void f("ÙŠÙ…ÙƒÙ†Ùƒ Ø±ÙØ¹ 10 ØµÙˆØ± ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰");const t=[],r=[];let s=!1;e.forEach(e=>{const i=(e=>["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type)?e.size>5242880?"Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£Ù‚Ù„ Ù…Ù† 5 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª":null:"Ø§Ù„ØµÙˆØ±Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ù…Ù† Ù†ÙˆØ¹ JPG, PNG, Ø£Ùˆ WebP")(e);if(i)return f(i),void(s=!0);t.push(e);const l=new FileReader;l.onload=i=>{r.push({file:e,preview:i.target.result}),r.length===t.length&&(n(e=>[...e,...t]),o(e=>[...e,...r]))},l.readAsDataURL(e)}),s||f("")},B=()=>c(this,null,function*(){const e=[];for(let t=0;t<i.length;t++){const n=i[t],r=`${_.id}/${Date.now()}_${t}_${n.name}`,{error:o}=yield le.storage.from("products").upload(r,n,{cacheControl:"3600",upsert:!1});if(o)throw new Error(`ÙØ´Ù„ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© ${t+1}: ${o.message}`);const{data:{publicUrl:s}}=le.storage.from("products").getPublicUrl(r);e.push(s),u(Math.round((t+1)/i.length*100))}return e});return k.jsx("div",{className:"container",children:k.jsxs("div",{className:"card",style:ze.card,children:[k.jsx("h1",{style:ze.title,children:"Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯"}),g&&k.jsx("div",{style:ze.error,children:g}),k.jsxs("form",{onSubmit:t=>c(this,null,function*(){if(t.preventDefault(),e.title&&e.description&&e.category)if(0!==i.length){l(!0),f("");try{const t=yield B(),i={user_id:_.id,title:e.title,description:e.description,category:e.category,images:t,status:"pending"};e.weight&&e.weight>0&&(i.weight=parseFloat(e.weight));const{data:n,error:r}=yield le.from("products").insert(i).select().single();if(r)throw r;const{data:o}=yield le.from("profiles").select("id").eq("role","admin");if(o&&o.length>0){const t=o.map(t=>({user_id:t.id,product_id:n.id,message:`Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ ÙŠØ­ØªØ§Ø¬ Ù…Ø±Ø§Ø¬Ø¹Ø©: ${e.title}`,type:"new_product"}));yield le.from("notifications").insert(t)}alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©. Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹"),C("/profile")}catch(n){f(n.message||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬")}finally{l(!1)}}else f("ÙŠØ±Ø¬Ù‰ Ø±ÙØ¹ ØµÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");else f("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©")}),style:ze.form,children:[k.jsxs("div",{style:ze.field,children:[k.jsx("label",{style:ze.label,children:"Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ *"}),k.jsx("input",{type:"text",className:"input",value:e.title,onChange:i=>t(d(a({},e),{title:i.target.value})),placeholder:"Ù…Ø«Ø§Ù„: Ù‡Ø§ØªÙ Ø¢ÙŠÙÙˆÙ† 12",required:!0})]}),k.jsxs("div",{style:ze.field,children:[k.jsx("label",{style:ze.label,children:"Ø§Ù„ÙØ¦Ø© *"}),k.jsxs("select",{className:"input",value:e.category,onChange:i=>t(d(a({},e),{category:i.target.value})),required:!0,children:[k.jsx("option",{value:"",children:"Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬"}),k.jsx("option",{value:"furniture",children:"Ø£Ø«Ø§Ø«"}),k.jsx("option",{value:"clothes",children:"Ù…Ù„Ø§Ø¨Ø³"}),k.jsx("option",{value:"books",children:"ÙƒØªØ¨"}),k.jsx("option",{value:"toys",children:"Ø£Ù„Ø¹Ø§Ø¨"}),k.jsx("option",{value:"appliances",children:"Ø£Ø¬Ù‡Ø²Ø© Ù…Ù†Ø²Ù„ÙŠØ©"}),k.jsx("option",{value:"sports",children:"Ø±ÙŠØ§Ø¶Ø©"}),k.jsx("option",{value:"jewelry",children:"Ù…Ø¬ÙˆÙ‡Ø±Ø§Øª ÙˆØ¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª"}),k.jsx("option",{value:"other",children:"Ø£Ø®Ø±Ù‰"})]})]}),k.jsxs("div",{style:ze.field,children:[k.jsx("label",{style:ze.label,children:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ *"}),k.jsx("textarea",{className:"input",rows:"5",value:e.description,onChange:i=>t(d(a({},e),{description:i.target.value})),placeholder:"Ø§ÙƒØªØ¨ ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ Ù„Ù„Ù…Ù†ØªØ¬ØŒ Ø­Ø§Ù„ØªÙ‡ØŒ Ù…Ù…ÙŠØ²Ø§ØªÙ‡...",required:!0})]}),k.jsxs("div",{style:ze.field,children:[k.jsx("label",{style:ze.label,children:"Ø§Ù„ÙˆØ²Ù† (ÙƒØ¬Ù…) - Ø§Ø®ØªÙŠØ§Ø±ÙŠ"}),k.jsx("input",{type:"number",step:"0.01",min:"0.01",className:"input",value:e.weight,onChange:i=>t(d(a({},e),{weight:i.target.value})),placeholder:"Ù…Ø«Ø§Ù„: 0.5"}),k.jsx("small",{style:ze.hint,children:"Ø£Ø¯Ø®Ù„ Ø§Ù„ÙˆØ²Ù† Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠ Ù„Ù„Ù…Ù†ØªØ¬ Ø¨Ø§Ù„ÙƒÙŠÙ„ÙˆØ¬Ø±Ø§Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"})]}),k.jsxs("div",{style:ze.field,children:[k.jsx("label",{style:ze.label,children:"ØµÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬ * (Ø­ØªÙ‰ 10 ØµÙˆØ±)"}),k.jsxs("div",{style:a(a({},ze.dropZone),w?ze.dropZoneDragging:{}),onDragOver:e=>{e.preventDefault(),S(!0)},onDragLeave:e=>{e.preventDefault(),S(!1)},onDrop:e=>{e.preventDefault(),S(!1);const t=Array.from(e.dataTransfer.files);N(t)},onClick:()=>{var e;return null==(e=v.current)?void 0:e.click()},children:[k.jsxs("div",{style:ze.dropZoneContent,children:[k.jsx("div",{style:ze.uploadIcon,children:"ðŸ“·"}),k.jsx("p",{style:ze.dropZoneText,children:w?"Ø£ÙÙ„Øª Ø§Ù„ØµÙˆØ± Ù‡Ù†Ø§":"Ø§Ø³Ø­Ø¨ ÙˆØ£ÙÙ„Øª Ø§Ù„ØµÙˆØ± Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±"}),k.jsx("p",{style:ze.dropZoneSubtext,children:"JPG, PNG, WebP Ø­ØªÙ‰ 5MB Ù„ÙƒÙ„ ØµÙˆØ±Ø©"})]}),k.jsx("input",{ref:v,type:"file",accept:"image/*",multiple:!0,onChange:e=>{const t=Array.from(e.target.files);N(t)},style:{display:"none"}})]}),r.length>0&&k.jsxs("div",{style:ze.imagePreviewContainer,children:[k.jsx("div",{style:ze.imagePreviewGrid,children:r.map((e,t)=>k.jsxs("div",{style:ze.imagePreviewItem,children:[k.jsx("img",{src:e.preview,alt:`Ù…Ø¹Ø§ÙŠÙ†Ø© ${t+1}`,style:ze.imagePreviewThumb,onClick:()=>(e=>{j(e),y(!0)})(t)}),k.jsx("button",{type:"button",style:ze.removeImageBtn,onClick:()=>(e=>{n(t=>t.filter((t,i)=>i!==e)),o(t=>t.filter((t,i)=>i!==e))})(t),children:"âœ•"})]},t))}),k.jsxs("p",{style:ze.imageCount,children:[r.length," ØµÙˆØ±Ø© Ù…Ø­Ø¯Ø¯Ø©"]})]}),x>0&&x<100&&k.jsxs("div",{style:ze.progressContainer,children:[k.jsx("div",{style:ze.progressBar,children:k.jsx("div",{style:d(a({},ze.progressFill),{width:`${x}%`})})}),k.jsxs("p",{style:ze.progressText,children:["Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±... ",x,"%"]})]}),k.jsx("small",{style:ze.hint,children:"Ø§Ù„ØªÙ‚Ø· ØµÙˆØ± ÙˆØ§Ø¶Ø­Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬ÙˆØ§Ù†Ø¨"})]}),k.jsx("button",{type:"submit",className:"btn btn-primary",disabled:s,style:ze.submitBtn,children:s?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...":"Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"})]}),k.jsx("div",{style:ze.note,children:k.jsx("p",{children:"ðŸ“ Ù…Ù„Ø§Ø­Ø¸Ø©: Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨"})}),m&&k.jsx(je,{images:r.map(e=>e.preview),initialIndex:b,onClose:()=>{y(!1)}})]})})}const ze={card:{maxWidth:"600px",margin:"0 auto"},title:{fontSize:"28px",marginBottom:"24px",textAlign:"center",color:"#f9fafb",fontWeight:"700"},error:{background:"#fee2e2",color:"#dc2626",padding:"12px",borderRadius:"8px",marginBottom:"16px",textAlign:"center"},form:{display:"flex",flexDirection:"column",gap:"20px"},field:{display:"flex",flexDirection:"column",gap:"8px"},label:{fontWeight:"600",color:"#e5e7eb",fontSize:"16px"},imageCount:{color:"#10b981",fontWeight:"600",fontSize:"14px"},hint:{fontSize:"13px",color:"#9ca3af",marginTop:"4px"},submitBtn:{width:"100%",padding:"14px",fontSize:"18px",fontWeight:"600"},note:{marginTop:"20px",padding:"16px",background:"rgba(107, 124, 89, 0.1)",borderRadius:"8px",border:"1px solid rgba(107, 124, 89, 0.3)",textAlign:"center",color:"#d1d5db",fontSize:"14px"},dropZone:{border:"2px dashed #d1d5db",borderRadius:"12px",padding:"40px 20px",textAlign:"center",cursor:"pointer",transition:"all 0.3s ease",backgroundColor:"rgba(31, 41, 55, 0.5)",marginBottom:"20px"},dropZoneDragging:{borderColor:"#6b7c59",backgroundColor:"rgba(107, 124, 89, 0.1)",transform:"scale(1.02)"},dropZoneContent:{display:"flex",flexDirection:"column",alignItems:"center",gap:"12px"},uploadIcon:{fontSize:"48px",opacity:"0.7"},dropZoneText:{fontSize:"18px",fontWeight:"600",color:"#e5e7eb",margin:"0"},dropZoneSubtext:{fontSize:"14px",color:"#9ca3af",margin:"0"},imagePreviewContainer:{marginTop:"20px"},imagePreviewGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"12px",marginBottom:"12px"},imagePreviewItem:{position:"relative",borderRadius:"8px",overflow:"hidden",border:"2px solid rgba(107, 124, 89, 0.3)",transition:"all 0.2s ease"},imagePreviewThumb:{width:"100%",height:"120px",objectFit:"cover",cursor:"pointer",display:"block"},removeImageBtn:{position:"absolute",top:"8px",left:"8px",background:"rgba(239, 68, 68, 0.9)",border:"none",borderRadius:"50%",width:"28px",height:"28px",color:"white",fontSize:"16px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},progressContainer:{marginTop:"20px"},progressBar:{height:"8px",backgroundColor:"rgba(31, 41, 55, 0.5)",borderRadius:"4px",overflow:"hidden",marginBottom:"8px"},progressFill:{height:"100%",backgroundColor:"#6b7c59",transition:"width 0.3s ease"},progressText:{textAlign:"center",color:"#6b7c59",fontWeight:"600",margin:"0"}};function Ie(){const{id:e}=m(),t=h(),{profile:i}=ae(),[n,r]=p.useState(!0),[o,s]=p.useState(!1),[l,x]=p.useState({title:"",description:"",category:"",condition:"",weight:"",suggested_price:"",choice_type:"sell",recycle_idea:""}),[u,g]=p.useState([]),[f,y]=p.useState([]),[b,j]=p.useState([]);p.useEffect(()=>{v()},[e]);const v=()=>c(this,null,function*(){try{const{data:n,error:o}=yield le.from("products").select("*").eq("id",e).single();if(o)throw o;if("admin"!==i.role&&n.user_id!==i.id)return alert("Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬"),void t("/profile");x({title:n.title||"",description:n.description||"",category:n.category||"",condition:n.condition||"",weight:n.weight||"",suggested_price:n.suggested_price||"",choice_type:n.choice_type||"sell",recycle_idea:n.recycle_idea||""}),g(n.images||[]),r(!1)}catch(n){alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬"),t("/profile")}}),w=e=>c(this,null,function*(){const t=[];for(const i of e){const e=i.name.split(".").pop(),n=`products/${Math.random().toString(36).substring(2)}-${Date.now()}.${e}`,{error:r}=yield le.storage.from("product-images").upload(n,i);if(r)throw r;const{data:{publicUrl:o}}=le.storage.from("product-images").getPublicUrl(n);t.push(o)}return t});return n?k.jsx("div",{className:"container",children:k.jsx("div",{style:We.loading,children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„..."})}):k.jsxs("div",{className:"container",children:[k.jsxs("div",{style:We.header,children:[k.jsx("h1",{style:We.title,children:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬"}),k.jsx("button",{className:"btn",onClick:()=>t(-1),style:We.backBtn,children:"â† Ø±Ø¬ÙˆØ¹"})]}),k.jsx("div",{className:"card",style:We.formCard,children:k.jsxs("form",{onSubmit:i=>c(this,null,function*(){if(i.preventDefault(),l.title&&l.description)if(u.length+f.length!==0)if("sell"!==l.choice_type||l.suggested_price){s(!0);try{let i=[];f.length>0&&(i=yield w(f));const n=[...u,...i],r={title:l.title,description:l.description,category:l.category,condition:l.condition,weight:l.weight?parseFloat(l.weight):null,images:n,choice_type:l.choice_type};"sell"===l.choice_type?(r.suggested_price=parseFloat(l.suggested_price),r.recycle_idea=null):(r.recycle_idea=l.recycle_idea,r.suggested_price=null);const{error:o}=yield le.from("products").update(r).eq("id",e);if(o)throw o;alert("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­!"),t("/profile")}catch(n){alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬: "+n.message)}finally{s(!1)}}else alert("ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­");else alert("ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");else alert("ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„ÙˆØµÙ")}),children:[k.jsxs("div",{style:We.field,children:[k.jsx("label",{style:We.label,children:"Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù†ØªØ¬ *"}),k.jsx("input",{type:"text",className:"input",value:l.title,onChange:e=>x(d(a({},l),{title:e.target.value})),required:!0})]}),k.jsxs("div",{style:We.field,children:[k.jsx("label",{style:We.label,children:"Ø§Ù„ÙˆØµÙ *"}),k.jsx("textarea",{className:"input",rows:"4",value:l.description,onChange:e=>x(d(a({},l),{description:e.target.value})),required:!0})]}),k.jsxs("div",{style:We.row,children:[k.jsxs("div",{style:We.field,children:[k.jsx("label",{style:We.label,children:"Ø§Ù„ÙØ¦Ø© *"}),k.jsxs("select",{className:"input",value:l.category,onChange:e=>x(d(a({},l),{category:e.target.value})),required:!0,children:[k.jsx("option",{value:"",children:"Ø§Ø®ØªØ± Ø§Ù„ÙØ¦Ø©"}),k.jsx("option",{value:"furniture",children:"Ø£Ø«Ø§Ø«"}),k.jsx("option",{value:"clothes",children:"Ù…Ù„Ø§Ø¨Ø³"}),k.jsx("option",{value:"books",children:"ÙƒØªØ¨"}),k.jsx("option",{value:"toys",children:"Ø£Ù„Ø¹Ø§Ø¨"}),k.jsx("option",{value:"appliances",children:"Ø£Ø¬Ù‡Ø²Ø© Ù…Ù†Ø²Ù„ÙŠØ©"}),k.jsx("option",{value:"sports",children:"Ø±ÙŠØ§Ø¶Ø©"}),k.jsx("option",{value:"jewelry",children:"Ù…Ø¬ÙˆÙ‡Ø±Ø§Øª ÙˆØ¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª"}),k.jsx("option",{value:"other",children:"Ø£Ø®Ø±Ù‰"})]})]}),k.jsxs("div",{style:We.field,children:[k.jsx("label",{style:We.label,children:"Ø§Ù„Ø­Ø§Ù„Ø© *"}),k.jsxs("select",{className:"input",value:l.condition,onChange:e=>x(d(a({},l),{condition:e.target.value})),required:!0,children:[k.jsx("option",{value:"",children:"Ø§Ø®ØªØ± Ø§Ù„Ø­Ø§Ù„Ø©"}),k.jsx("option",{value:"Ø¬Ø¯ÙŠØ¯",children:"Ø¬Ø¯ÙŠØ¯"}),k.jsx("option",{value:"Ù…Ø³ØªØ¹Ù…Ù„ - Ù…Ù…ØªØ§Ø²",children:"Ù…Ø³ØªØ¹Ù…Ù„ - Ù…Ù…ØªØ§Ø²"}),k.jsx("option",{value:"Ù…Ø³ØªØ¹Ù…Ù„ - Ø¬ÙŠØ¯",children:"Ù…Ø³ØªØ¹Ù…Ù„ - Ø¬ÙŠØ¯"}),k.jsx("option",{value:"Ù…Ø³ØªØ¹Ù…Ù„ - Ù…Ù‚Ø¨ÙˆÙ„",children:"Ù…Ø³ØªØ¹Ù…Ù„ - Ù…Ù‚Ø¨ÙˆÙ„"})]})]})]}),k.jsxs("div",{style:We.field,children:[k.jsx("label",{style:We.label,children:"Ø§Ù„ÙˆØ²Ù† (ÙƒØ¬Ù…) - Ø§Ø®ØªÙŠØ§Ø±ÙŠ"}),k.jsx("input",{type:"number",step:"0.1",className:"input",value:l.weight,onChange:e=>x(d(a({},l),{weight:e.target.value})),placeholder:"Ù…Ø«Ø§Ù„: 2.5"})]}),k.jsxs("div",{style:We.field,children:[k.jsx("label",{style:We.label,children:"Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© *"}),k.jsxs("div",{style:We.radioGroup,children:[k.jsxs("label",{style:We.radioLabel,children:[k.jsx("input",{type:"radio",value:"sell",checked:"sell"===l.choice_type,onChange:e=>x(d(a({},l),{choice_type:e.target.value}))}),k.jsx("span",{children:"Ø¨ÙŠØ¹"})]}),k.jsxs("label",{style:We.radioLabel,children:[k.jsx("input",{type:"radio",value:"recycle",checked:"recycle"===l.choice_type,onChange:e=>x(d(a({},l),{choice_type:e.target.value}))}),k.jsx("span",{children:"Ø¥Ø¹Ø§Ø¯Ø© ØªØ¯ÙˆÙŠØ±"})]})]})]}),"sell"===l.choice_type?k.jsxs("div",{style:We.field,children:[k.jsx("label",{style:We.label,children:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­ (Ø¬Ù†ÙŠÙ‡) *"}),k.jsx("input",{type:"number",className:"input",value:l.suggested_price,onChange:e=>x(d(a({},l),{suggested_price:e.target.value})),max:"500",required:!0})]}):k.jsxs("div",{style:We.field,children:[k.jsx("label",{style:We.label,children:"ÙÙƒØ±Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¯ÙˆÙŠØ±"}),k.jsx("textarea",{className:"input",rows:"3",value:l.recycle_idea,onChange:e=>x(d(a({},l),{recycle_idea:e.target.value})),placeholder:"Ø§ÙƒØªØ¨ ÙÙƒØ±ØªÙƒ Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬..."})]}),u.length>0&&k.jsxs("div",{style:We.field,children:[k.jsx("label",{style:We.label,children:"Ø§Ù„ØµÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©"}),k.jsx("div",{style:We.imagesGrid,children:u.map((e,t)=>k.jsxs("div",{style:We.imagePreview,children:[k.jsx("img",{src:e,alt:`ØµÙˆØ±Ø© ${t+1}`,style:We.previewImg}),k.jsx("button",{type:"button",onClick:()=>(e=>{g(u.filter((t,i)=>i!==e))})(t),style:We.removeBtn,children:"âœ•"})]},t))})]}),b.length>0&&k.jsxs("div",{style:We.field,children:[k.jsx("label",{style:We.label,children:"ØµÙˆØ± Ø¬Ø¯ÙŠØ¯Ø©"}),k.jsx("div",{style:We.imagesGrid,children:b.map((e,t)=>k.jsxs("div",{style:We.imagePreview,children:[k.jsx("img",{src:e,alt:`ØµÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø© ${t+1}`,style:We.previewImg}),k.jsx("button",{type:"button",onClick:()=>(e=>{y(f.filter((t,i)=>i!==e)),j(b.filter((t,i)=>i!==e))})(t),style:We.removeBtn,children:"âœ•"})]},t))})]}),u.length+f.length<5&&k.jsxs("div",{style:We.field,children:[k.jsxs("label",{style:We.label,children:["Ø¥Ø¶Ø§ÙØ© ØµÙˆØ± Ø¬Ø¯ÙŠØ¯Ø© (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ ",5-u.length-f.length," ØµÙˆØ±)"]}),k.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>{const t=Array.from(e.target.files);u.length+f.length+t.length>5?alert("Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 5 ØµÙˆØ±"):(y([...f,...t]),t.forEach(e=>{const t=new FileReader;t.onloadend=()=>{j(e=>[...e,t.result])},t.readAsDataURL(e)}))},style:We.fileInput,className:"input"})]}),k.jsx("button",{type:"submit",className:"btn btn-primary",style:We.submitBtn,disabled:o,children:o?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...":"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª"})]})})]})}const We={header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px",flexWrap:"wrap",gap:"16px"},title:{fontSize:"32px",color:"#000000",margin:0,fontWeight:"600"},backBtn:{background:"#8b7355",color:"white",borderRadius:"20px"},loading:{textAlign:"center",padding:"60px",fontSize:"18px",color:"#7a7a7a"},formCard:{padding:"32px"},field:{marginBottom:"24px"},row:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px"},label:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#000000",fontSize:"14px"},radioGroup:{display:"flex",gap:"24px"},radioLabel:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"15px",fontWeight:"500"},imagesGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"16px"},imagePreview:{position:"relative",borderRadius:"12px",overflow:"hidden",border:"2px solid #e5e7eb"},previewImg:{width:"100%",height:"150px",objectFit:"cover"},removeBtn:{position:"absolute",top:"8px",right:"8px",background:"#ef4444",color:"white",border:"none",borderRadius:"50%",width:"28px",height:"28px",cursor:"pointer",fontSize:"16px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center"},fileInput:{padding:"12px",cursor:"pointer"},submitBtn:{width:"100%",padding:"14px",fontSize:"16px"}};function Te(){const e=h(),{profile:t,signOut:i}=ae(),{fetchUserProducts:n,acceptNegotiation:r,rejectNegotiation:o}=be(),[s,l]=p.useState([]),[x,u]=p.useState(null),g=()=>c(this,null,function*(){try{u(null);const e=yield n(t.id);l(e)}catch(e){u(e.message||"ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª")}}),f=()=>{setLoading(!0),u(null),g()};p.useEffect(()=>{g()},[t.id]);const m=e=>c(this,null,function*(){if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ù‚Ø¨ÙˆÙ„ Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ØŸ"))try{yield r(e),alert("ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¹Ø±Ø¶! Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ù…Ù†ØªØ¬Ùƒ Ù„Ù„Ø¨ÙŠØ¹"),g()}catch(t){alert("Ø®Ø·Ø£ ÙÙŠ Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¹Ø±Ø¶")}}),y=e=>c(this,null,function*(){if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø±ÙØ¶ Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¹Ø±ØŸ Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù„ØªÙØ§ÙˆØ¶ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰"))try{yield o(e),alert("Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨Ùƒ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©"),g()}catch(t){alert("Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¶ Ø§Ù„Ø¹Ø±Ø¶")}}),b=e=>({pending:"#f59e0b",approved:"#10b981",rejected:"#ef4444",awaiting_seller:"#3b82f6"}[e]||"#6b7280");return x?k.jsx("div",{className:"container",children:k.jsxs("div",{className:"card",style:Re.error,children:[k.jsx("h2",{children:"Ø­Ø¯Ø« Ø®Ø·Ø£"}),k.jsx("p",{children:x}),k.jsx("button",{className:"btn btn-primary",onClick:f,children:"Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©"})]})}):k.jsx(de,{onRetry:f,children:k.jsxs("div",{className:"container",children:[k.jsxs("div",{style:Re.statsGrid,children:[k.jsxs("div",{className:"stats-card",children:[k.jsxs("svg",{style:{width:"48px",height:"48px",margin:"0 auto 16px"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[k.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),k.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),k.jsxs("div",{style:{marginTop:"16px"},children:[k.jsx("div",{className:"stats-number",children:s.length}),k.jsx("div",{className:"stats-label",children:"Ù…Ù†ØªØ¬Ø§ØªÙŠ"})]})]}),k.jsxs("div",{className:"stats-card",children:[k.jsxs("svg",{style:{width:"48px",height:"48px",margin:"0 auto 16px"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[k.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),k.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),k.jsxs("div",{style:{marginTop:"16px"},children:[k.jsx("div",{className:"stats-number",children:s.filter(e=>"approved"===e.status).length}),k.jsx("div",{className:"stats-label",children:"ØªÙ… Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©"})]})]}),k.jsxs("div",{className:"stats-card",children:[k.jsxs("svg",{style:{width:"48px",height:"48px",margin:"0 auto 16px"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[k.jsx("circle",{cx:"12",cy:"12",r:"10"}),k.jsx("polyline",{points:"12 6 12 12 16 14"})]}),k.jsxs("div",{style:{marginTop:"16px"},children:[k.jsx("div",{className:"stats-number",children:s.filter(e=>"pending"===e.status).length}),k.jsx("div",{className:"stats-label",children:"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"})]})]})]}),k.jsx("div",{className:"glow-divider"}),k.jsxs("div",{className:"card",style:Re.profileCard,children:[k.jsxs("div",{style:Re.profileHeader,children:[k.jsx("h1",{style:Re.title,className:"netflix-shimmer",children:"Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ"}),k.jsx("button",{className:"btn btn-danger",onClick:i,style:Re.logoutBtn,children:"ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬"})]}),k.jsxs("div",{style:Re.info,children:[k.jsxs("div",{style:Re.infoRow,children:[k.jsx("span",{style:Re.label,children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:"}),k.jsx("span",{style:Re.value,children:t.username})]}),k.jsxs("div",{style:Re.infoRow,children:[k.jsx("span",{style:Re.label,children:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:"}),k.jsx("span",{style:Re.value,children:t.email})]}),k.jsxs("div",{style:Re.infoRow,children:[k.jsx("span",{style:Re.label,children:"Ø§Ù„Ù…ÙˆÙ‚Ø¹:"}),k.jsx("span",{style:Re.value,children:t.location})]}),k.jsxs("div",{style:Re.infoRow,children:[k.jsx("span",{style:Re.label,children:"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:"}),k.jsx("span",{style:Re.value,children:t.phone})]})]})]}),x?k.jsxs("div",{className:"card",style:Re.errorCard,children:[k.jsx("h3",{style:Re.errorTitle,children:"Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª"}),k.jsx("p",{style:Re.errorMessage,children:x}),k.jsx("button",{className:"btn btn-primary",onClick:f,children:"Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©"})]}):k.jsxs("div",{style:Re.productsSection,children:[k.jsxs("h2",{style:Re.subtitle,children:["Ù…Ù†ØªØ¬Ø§ØªÙŠ (",s.length,")"]}),0===s.length?k.jsx("div",{style:Re.empty,children:k.jsx("p",{children:"Ù„Ù… ØªÙ‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø¹Ø¯"})}):k.jsx("div",{style:Re.productsList,children:s.map(t=>{return k.jsx("div",{className:"card",style:Re.productCard,children:k.jsxs("div",{style:Re.productLayout,children:[t.images&&t.images.length>0&&k.jsxs("div",{style:Re.productImages,children:[k.jsx("img",{src:t.images[0],alt:t.title,style:Re.productImage,loading:"lazy",onError:e=>{e.target.src="https://placehold.co/180x180/e2e8f0/64748b?text=Image+Not+Found"}}),t.images.length>1&&k.jsxs("div",{style:Re.imageCount,children:["+",t.images.length-1]})]}),k.jsxs("div",{style:Re.productInfo,children:[k.jsxs("div",{style:Re.productHeader,children:[k.jsx("h3",{style:Re.productTitle,children:t.title}),k.jsx("span",{style:d(a({},Re.status),{background:b(t.status)+"20",color:b(t.status)}),children:(n=t.status,{pending:"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©",approved:"ØªÙ… Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©",rejected:"Ù…Ø±ÙÙˆØ¶",awaiting_seller:"ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙˆØ§ÙÙ‚ØªÙƒ"}[n]||n)})]}),k.jsx("p",{style:Re.productDesc,children:t.description}),k.jsxs("div",{style:Re.productDetails,children:[t.category&&k.jsxs("span",{children:["Ø§Ù„ÙØ¦Ø©: ",(i=t.category,{furniture:"Ø£Ø«Ø§Ø«",clothes:"Ù…Ù„Ø§Ø¨Ø³",books:"ÙƒØªØ¨",toys:"Ø£Ù„Ø¹Ø§Ø¨",appliances:"Ø£Ø¬Ù‡Ø²Ø© Ù…Ù†Ø²Ù„ÙŠØ©",sports:"Ø±ÙŠØ§Ø¶Ø©",jewelry:"Ù…Ø¬ÙˆÙ‡Ø±Ø§Øª ÙˆØ¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª",other:"Ø£Ø®Ø±Ù‰"}[i]||i)]}),t.weight&&k.jsxs("span",{children:["Ø§Ù„ÙˆØ²Ù†: ",t.weight," ÙƒØ¬Ù…"]}),t.condition&&k.jsxs("span",{children:["Ø§Ù„Ø­Ø§Ù„Ø©: ",t.condition]}),k.jsx("span",{children:"recycle"===t.choice_type?"Ø¥Ø¹Ø§Ø¯Ø© ØªØ¯ÙˆÙŠØ±":t.final_price?`Ø§Ù„Ø³Ø¹Ø±: ${t.final_price} Ø¬Ù†ÙŠÙ‡`:t.suggested_price?`Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­: ${t.suggested_price} Ø¬Ù†ÙŠÙ‡`:"ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªØ³Ø¹ÙŠØ±"})]}),"recycle"===t.choice_type&&t.recycle_idea&&k.jsxs("div",{style:Re.recycleInfo,children:[k.jsx("strong",{children:"ÙÙƒØ±Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¯ÙˆÙŠØ±:"}),k.jsx("p",{children:t.recycle_idea})]}),"awaiting_seller"===t.status&&t.negotiated_price&&k.jsxs("div",{style:Re.negotiationOffer,children:[k.jsx("h4",{style:Re.negotiationTitle,children:"Ø¹Ø±Ø¶ Ø³Ø¹Ø± Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©"}),k.jsxs("div",{style:Re.priceComparison,children:[k.jsxs("div",{children:[k.jsx("span",{style:Re.priceLabel,children:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­ Ù…Ù†Ùƒ:"}),k.jsxs("span",{style:Re.oldPrice,children:[t.suggested_price," Ø¬Ù†ÙŠÙ‡"]})]}),k.jsxs("div",{children:[k.jsx("span",{style:Re.priceLabel,children:"Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙŠØ¯:"}),k.jsxs("span",{style:Re.newPrice,children:[t.negotiated_price," Ø¬Ù†ÙŠÙ‡"]})]})]}),t.negotiation_note&&k.jsxs("p",{style:Re.negotiationNote,children:[k.jsx("strong",{children:"Ù…Ù„Ø§Ø­Ø¸Ø©:"})," ",t.negotiation_note]}),k.jsxs("div",{style:Re.negotiationActions,children:[k.jsx("button",{className:"btn btn-primary",onClick:()=>m(t.id),children:"Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¹Ø±Ø¶"}),k.jsx("button",{className:"btn btn-danger",onClick:()=>y(t.id),children:"Ø±ÙØ¶ Ø§Ù„Ø¹Ø±Ø¶"})]})]}),t.rejection_reason&&k.jsxs("div",{style:Re.rejection,children:[k.jsx("strong",{children:"Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶:"})," ",t.rejection_reason]}),k.jsx("div",{style:Re.productActions,children:k.jsx("button",{className:"btn",style:Re.editBtn,onClick:()=>e(`/edit-product/${t.id}`),children:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬"})})]})]})},t.id);var i,n})})]})]})})}const Re={statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"24px",marginBottom:"40px"},productActions:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid rgba(107, 124, 89, 0.1)"},editBtn:{background:"#3b82f6",color:"white",borderRadius:"20px",padding:"10px 24px"},profileCard:{marginBottom:"40px",padding:"40px"},profileHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px",flexWrap:"wrap",gap:"16px"},title:{fontSize:"36px",color:"#f9fafb",fontWeight:"800",display:"flex",alignItems:"center"},logoutBtn:{fontSize:"14px",padding:"10px 20px"},info:{display:"flex",flexDirection:"column",gap:"16px"},infoRow:{display:"flex",justifyContent:"space-between",padding:"16px",background:"rgba(107, 124, 89, 0.04)",borderRadius:"16px",border:"1px solid rgba(107, 124, 89, 0.08)"},label:{fontWeight:"600",color:"#d1d5db",fontSize:"14px"},value:{color:"#f9fafb",fontWeight:"600"},productsSection:{marginTop:"48px"},subtitle:{fontSize:"28px",color:"#f9fafb",marginBottom:"32px",fontWeight:"700"},empty:{textAlign:"center",padding:"60px",color:"#999",fontSize:"16px"},errorCard:{textAlign:"center",padding:"40px",background:"rgba(220, 38, 38, 0.05)",border:"1px solid rgba(220, 38, 38, 0.2)"},errorTitle:{color:"#dc2626",marginBottom:"8px"},errorMessage:{color:"#9ca3af",marginBottom:"24px"},productsList:{display:"flex",flexDirection:"column",gap:"24px"},productCard:{transition:"all 0.3s ease",padding:"24px"},productLayout:{display:"flex",gap:"24px",flexWrap:"wrap"},productImages:{position:"relative",flex:"0 0 180px",height:"180px"},productImage:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"16px"},imageCount:{position:"absolute",bottom:"12px",right:"12px",background:"rgba(107, 124, 89, 0.9)",backdropFilter:"blur(8px)",color:"white",padding:"6px 12px",borderRadius:"16px",fontSize:"13px",fontWeight:"500"},productInfo:{flex:"1",minWidth:"280px"},productHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",gap:"12px"},productTitle:{fontSize:"20px",fontWeight:"700",color:"#f9fafb"},status:{padding:"8px 16px",borderRadius:"20px",fontSize:"13px",fontWeight:"500",whiteSpace:"nowrap"},productDesc:{color:"#d1d5db",marginBottom:"16px",lineHeight:"1.6",fontSize:"15px"},productDetails:{display:"flex",justifyContent:"space-between",gap:"16px",flexWrap:"wrap",fontSize:"14px",color:"#9ca3af",paddingTop:"16px",borderTop:"1px solid rgba(107, 124, 89, 0.1)"},rejection:{marginTop:"16px",padding:"16px",background:"rgba(139, 115, 85, 0.08)",color:"#8b7355",borderRadius:"16px",fontSize:"14px",border:"1px solid rgba(139, 115, 85, 0.2)"},recycleInfo:{marginTop:"16px",padding:"16px",background:"rgba(107, 124, 89, 0.08)",color:"#556b2f",borderRadius:"16px",fontSize:"14px",border:"1px solid rgba(107, 124, 89, 0.2)"},negotiationOffer:{marginTop:"16px",padding:"20px",background:"rgba(107, 124, 89, 0.06)",borderRadius:"20px",border:"1px solid rgba(107, 124, 89, 0.15)"},negotiationTitle:{fontSize:"18px",fontWeight:"700",color:"#f9fafb",marginBottom:"16px"},priceComparison:{display:"flex",justifyContent:"space-around",marginBottom:"16px",gap:"20px",flexWrap:"wrap"},priceLabel:{display:"block",fontSize:"13px",color:"#9ca3af",marginBottom:"6px",fontWeight:"500"},oldPrice:{display:"block",fontSize:"18px",fontWeight:"500",color:"#b0b0b0",textDecoration:"line-through"},newPrice:{display:"block",fontSize:"22px",fontWeight:"600",color:"#6b7c59"},negotiationNote:{background:"rgba(107, 124, 89, 0.1)",padding:"14px",borderRadius:"12px",fontSize:"14px",marginBottom:"16px",color:"#d1d5db",lineHeight:"1.6",border:"1px solid rgba(107, 124, 89, 0.2)"},negotiationActions:{display:"flex",gap:"12px",flexWrap:"wrap"}};function De(){const[e,t]=p.useState([]),[i,n]=p.useState([]),[r,o]=p.useState(null),[s,l]=p.useState(""),[x,u]=p.useState(""),[g,h]=p.useState(null),[f,m]=p.useState(0),[y,b]=p.useState(null),{fetchPendingProducts:j,approveProduct:v,rejectProduct:w,negotiateProduct:S}=be(),_=e=>{var t;return"pending"===e.status&&e.final_price&&(null==(t=e.negotiation_note)?void 0:t.includes("Ø§Ù„Ø¨Ø§Ø¦Ø¹ ÙˆØ§ÙÙ‚"))?"ðŸŽ‰ Ø§Ù„Ø¨Ø§Ø¦Ø¹ ÙˆØ§ÙÙ‚ - ÙŠØ­ØªØ§Ø¬ Ù…ÙˆØ§ÙÙ‚ØªÙƒ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©":e.seller_rejected_negotiation?"ðŸ”´ Ø§Ù„Ø¨Ø§Ø¦Ø¹ Ø±ÙØ¶ Ø§Ù„Ø³Ø¹Ø±":e.rejected_initial_price?"âŒ Ø±ÙØ¶ Ø§Ù„Ø³Ø¹Ø±":{pending:"â³ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯",approved:"âœ… ØªÙ… Ø§Ù„Ù‚Ø¨ÙˆÙ„",rejected:"âŒ Ù…Ø±ÙÙˆØ¶ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹",awaiting_seller:"â° ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø±Ø¯ Ø§Ù„Ø¨Ø§Ø¦Ø¹"}[e.status]||e.status},C=e=>{var t;const i=a({},Ee.statusBadge);return"pending"===e.status&&e.final_price&&(null==(t=e.negotiation_note)?void 0:t.includes("Ø§Ù„Ø¨Ø§Ø¦Ø¹ ÙˆØ§ÙÙ‚"))?d(a({},i),{background:"#10b981",color:"#ffffff",border:"3px solid #059669",fontWeight:"bold",fontSize:"14px",animation:"pulse 2s infinite"}):e.seller_rejected_negotiation?d(a({},i),{background:"#dc2626",color:"#ffffff",border:"3px solid #991b1b",fontWeight:"bold",fontSize:"14px",animation:"pulse 2s infinite"}):e.rejected_initial_price?d(a({},i),{background:"#fee2e2",color:"#dc2626",border:"2px solid #ef4444",fontWeight:"bold"}):a(a({},i),{pending:{background:"#fef3c7",color:"#000000",border:"2px solid #f59e0b"},approved:{background:"#f0fdf4",color:"#166534",border:"2px solid #10b981"},rejected:{background:"#fee2e2",color:"#991b1b",border:"2px solid #ef4444"},awaiting_seller:{background:"#eff6ff",color:"#000000",border:"2px solid #3b82f6"}}[e.status])};p.useEffect(()=>{let e=!0,i=null;return(()=>{c(this,null,function*(){try{i=setTimeout(()=>{e&&(t([]),n([]))},15e3),e&&(yield N())}catch(r){}finally{i&&clearTimeout(i)}})})(),()=>{e=!1,i&&clearTimeout(i)}},[]);const N=()=>c(this,null,function*(){try{const{data:{user:e},error:i}=yield le.auth.getUser();if(i)throw i;if(!e)return alert("ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹"),void(window.location.href="/login");const{data:r,error:o}=yield le.from("profiles").select("role").eq("id",e.id).single();if(o)throw o;if(b(null==r?void 0:r.role),"admin"!==(null==r?void 0:r.role))return alert("Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©"),void(window.location.href="/");const s=yield j();t(s||[]);const{data:l,error:a}=yield le.from("profiles").select("*").order("created_at",{ascending:!1});a||n(l||[])}catch(e){if("AbortError"===e.name)return;const i=e.message||"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: "+i),t([]),n([])}}),B=(e,t)=>c(this,null,function*(){try{yield v(e,t),alert("ØªÙ… Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬"),N(),o(null)}catch(i){alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬")}}),z=(e,t)=>c(this,null,function*(){try{yield w(e,t),alert("ØªÙ… Ø±ÙØ¶ Ø§Ù„Ù…Ù†ØªØ¬"),N(),o(null)}catch(i){alert("Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¶ Ø§Ù„Ù…Ù†ØªØ¬")}}),I=e=>c(this,null,function*(){if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡."))try{const{error:t}=yield le.from("products").delete().eq("id",e);if(t)throw t;alert("ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­"),N()}catch(t){alert("Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬: "+t.message)}});return k.jsxs("div",{className:"container",children:[k.jsx("h1",{style:Ee.title,children:"Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©"}),k.jsxs("div",{style:Ee.stats,children:[k.jsxs("div",{className:"card",style:Ee.statCard,children:[k.jsx("h3",{style:Ee.statNumber,children:e.length}),k.jsx("p",{style:Ee.statLabel,children:"Ù…Ù†ØªØ¬Ø§Øª Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"})]}),k.jsxs("div",{className:"card",style:Ee.statCard,children:[k.jsx("h3",{style:Ee.statNumber,children:i.length}),k.jsx("p",{style:Ee.statLabel,children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†"})]})]}),k.jsxs("div",{style:Ee.section,children:[k.jsx("h2",{style:Ee.subtitle,children:"Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"}),0===e.length?k.jsx("div",{style:Ee.empty,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"}):k.jsx("div",{style:Ee.productsList,children:e.map(e=>{var t,i,n,r,s,a;return k.jsxs("div",{className:"card",style:Ee.productCard,children:[k.jsx("div",{style:Ee.productImages,children:e.images.slice(0,4).map((t,i)=>k.jsx("img",{src:t,alt:`ØµÙˆØ±Ø© ${i+1}`,style:Ee.productImage,onClick:()=>{h(e.images),m(i)}},i))}),k.jsxs("div",{style:Ee.productInfo,children:[k.jsxs("div",{style:Ee.productHeader,children:[k.jsx("h3",{style:Ee.productTitle,children:e.title}),k.jsx("span",{style:C(e),children:_(e)})]}),k.jsx("p",{style:Ee.productDesc,children:e.description}),e.seller_rejected_negotiation&&k.jsxs("div",{style:Ee.rejectionWarning,children:[k.jsx("strong",{children:"âš ï¸ ØªÙ†Ø¨ÙŠÙ‡:"})," Ø§Ù„Ø¨Ø§Ø¦Ø¹ Ø±ÙØ¶ Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ÙˆØ¶ Ø§Ù„Ø³Ø§Ø¨Ù‚ ÙˆÙŠØ­ØªØ§Ø¬ ØªÙØ§ÙˆØ¶ Ø¬Ø¯ÙŠØ¯",e.negotiation_note&&k.jsx("p",{style:Ee.rejectionNote,children:e.negotiation_note})]}),"pending"===e.status&&e.final_price&&(null==(t=e.negotiation_note)?void 0:t.includes("Ø§Ù„Ø¨Ø§Ø¦Ø¹ ÙˆØ§ÙÙ‚"))&&k.jsxs("div",{style:Ee.acceptanceNotice,children:[k.jsx("strong",{children:"âœ… Ø§Ù„Ø¨Ø§Ø¦Ø¹ ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¶!"}),k.jsxs("p",{children:["Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡: ",k.jsxs("span",{style:Ee.agreedPrice,children:[e.final_price," Ø¬Ù†ÙŠÙ‡"]})]}),k.jsx("p",{style:Ee.noticeText,children:"ÙŠØ­ØªØ§Ø¬ Ù…ÙˆØ§ÙÙ‚ØªÙƒ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ù„Ù†Ø´Ø± Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚"})]}),k.jsxs("div",{style:Ee.productDetails,children:[e.category&&k.jsxs("div",{style:Ee.detailRow,children:[k.jsx("span",{style:Ee.detailLabel,children:"Ø§Ù„ÙØ¦Ø©:"}),k.jsx("span",{style:Ee.sellerData,children:(a=e.category,{furniture:"Ø£Ø«Ø§Ø«",clothes:"Ù…Ù„Ø§Ø¨Ø³",books:"ÙƒØªØ¨",toys:"Ø£Ù„Ø¹Ø§Ø¨",appliances:"Ø£Ø¬Ù‡Ø²Ø© Ù…Ù†Ø²Ù„ÙŠØ©",sports:"Ø±ÙŠØ§Ø¶Ø©",jewelry:"Ù…Ø¬ÙˆÙ‡Ø±Ø§Øª ÙˆØ¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª",other:"Ø£Ø®Ø±Ù‰"}[a]||a)})]}),e.weight&&k.jsxs("div",{style:Ee.detailRow,children:[k.jsx("span",{style:Ee.detailLabel,children:"Ø§Ù„ÙˆØ²Ù†:"}),k.jsxs("span",{style:Ee.sellerData,children:[e.weight," ÙƒØ¬Ù…"]})]}),e.condition&&k.jsxs("div",{style:Ee.detailRow,children:[k.jsx("span",{style:Ee.detailLabel,children:"Ø§Ù„Ø­Ø§Ù„Ø©:"}),k.jsx("span",{style:Ee.sellerData,children:e.condition})]}),e.original_price&&k.jsxs("div",{style:Ee.detailRow,children:[k.jsx("span",{style:Ee.detailLabel,children:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£ØµÙ„ÙŠ:"}),k.jsxs("span",{children:[e.original_price," Ø¬Ù†ÙŠÙ‡"]})]}),e.suggested_price&&k.jsxs("div",{style:Ee.detailRow,children:[k.jsx("span",{style:Ee.detailLabel,children:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­:"}),k.jsxs("span",{style:Ee.priceHighlight,children:[e.suggested_price," Ø¬Ù†ÙŠÙ‡"]})]}),e.discount_percentage&&k.jsxs("div",{style:Ee.detailRow,children:[k.jsx("span",{style:Ee.detailLabel,children:"Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ®ÙÙŠØ¶:"}),k.jsxs("span",{style:Ee.discountBadge,children:[e.discount_percentage,"%"]})]}),e.choice_type&&k.jsxs("div",{style:Ee.detailRow,children:[k.jsx("span",{style:Ee.detailLabel,children:"Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨:"}),k.jsx("span",{children:"recycle"===e.choice_type?"Ø¥Ø¹Ø§Ø¯Ø© ØªØ¯ÙˆÙŠØ±":"Ø¨ÙŠØ¹"})]})]}),k.jsxs("div",{style:Ee.sellerInfo,children:[k.jsx("h4",{style:Ee.sellerTitle,children:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨Ø§Ø¦Ø¹"}),k.jsxs("div",{style:Ee.detailRow,children:[k.jsx("span",{style:Ee.detailLabel,children:"Ø§Ù„Ø§Ø³Ù…:"}),k.jsx("span",{style:Ee.sellerData,children:null==(i=e.profiles)?void 0:i.username})]}),k.jsxs("div",{style:Ee.detailRow,children:[k.jsx("span",{style:Ee.detailLabel,children:"Ø§Ù„Ø¨Ø±ÙŠØ¯:"}),k.jsx("span",{style:Ee.sellerData,children:null==(n=e.profiles)?void 0:n.email})]}),k.jsxs("div",{style:Ee.detailRow,children:[k.jsx("span",{style:Ee.detailLabel,children:"Ø§Ù„Ù‡Ø§ØªÙ:"}),k.jsx("span",{style:Ee.sellerData,children:null==(r=e.profiles)?void 0:r.phone})]}),k.jsxs("div",{style:Ee.detailRow,children:[k.jsx("span",{style:Ee.detailLabel,children:"Ø§Ù„Ù…ÙˆÙ‚Ø¹:"}),k.jsx("span",{style:Ee.sellerData,children:null==(s=e.profiles)?void 0:s.location})]})]}),(!e.choice_type||"sell"===e.choice_type)&&k.jsxs("div",{style:Ee.actions,children:[k.jsx("button",{className:"btn btn-primary",onClick:()=>{const t=prompt("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ù…Ù†ØªØ¬ (Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡):");t&&t>0&&B(e.id,t)},children:"Ù…ÙˆØ§ÙÙ‚Ø© ÙˆØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø³Ø¹Ø±"}),k.jsx("button",{className:"btn btn-secondary",onClick:()=>(e=>{o(e),l(e.suggested_price),u("")})(e),children:"ØªÙØ§ÙˆØ¶"}),k.jsx("button",{className:"btn",style:{background:"#3b82f6",color:"white"},onClick:()=>window.location.href=`/bekya2.1/edit-product/${e.id}`,children:"ØªØ¹Ø¯ÙŠÙ„"}),k.jsx("button",{className:"btn btn-danger",onClick:()=>{const t=prompt("Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶:");t&&z(e.id,t)},children:"Ø±ÙØ¶"}),k.jsx("button",{className:"btn",style:{background:"#dc2626",color:"white"},onClick:()=>I(e.id),children:"Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ"})]}),"recycle"===e.choice_type&&k.jsxs("div",{style:Ee.recycleNote,children:[k.jsx("p",{children:k.jsx("strong",{children:"ÙÙƒØ±Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¯ÙˆÙŠØ±:"})}),k.jsx("p",{children:e.recycle_idea}),k.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"12px"},children:[k.jsx("button",{className:"btn btn-primary",onClick:()=>B(e.id,0),children:"Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¯ÙˆÙŠØ±"}),k.jsx("button",{className:"btn",style:{background:"#3b82f6",color:"white"},onClick:()=>window.location.href=`/bekya2.1/edit-product/${e.id}`,children:"ØªØ¹Ø¯ÙŠÙ„"}),k.jsx("button",{className:"btn",style:{background:"#dc2626",color:"white"},onClick:()=>I(e.id),children:"Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ"})]})]})]})]},e.id)})})]}),r&&k.jsx("div",{style:Ee.modal,children:k.jsxs("div",{className:"card",style:Ee.modalContent,children:[k.jsx("h3",{style:Ee.modalTitle,children:"Ø§Ù„ØªÙØ§ÙˆØ¶ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¹Ø±"}),k.jsxs("p",{children:["Ø§Ù„Ù…Ù†ØªØ¬: ",r.title]}),r.suggested_price&&k.jsxs("p",{children:["Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­ Ø§Ù„Ø³Ø§Ø¨Ù‚: ",r.suggested_price," Ø¬Ù†ÙŠÙ‡"]}),k.jsxs("div",{style:Ee.field,children:[k.jsx("label",{style:Ee.label,children:"Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¹Ø±:"}),k.jsx("input",{type:"number",className:"input",value:s,onChange:e=>l(e.target.value),placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨"})]}),k.jsxs("div",{style:Ee.field,children:[k.jsx("label",{style:Ee.label,children:"Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„Ø¨Ø§Ø¦Ø¹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):"}),k.jsx("textarea",{className:"input",rows:"3",value:x,onChange:e=>u(e.target.value),placeholder:"Ù…Ø«Ø§Ù„: Ø§Ù„Ø³Ø¹Ø± Ù…Ø±ØªÙØ¹ Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ø¨Ø³Ø¨Ø¨ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù†ØªØ¬"})]}),k.jsxs("div",{style:Ee.modalActions,children:[k.jsx("button",{className:"btn btn-primary",onClick:()=>c(this,null,function*(){if(!s||s<=0)alert("ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø³Ø¹Ø± ØµØ­ÙŠØ­");else try{yield S(r.id,s,x),alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ÙˆØ¶ Ù„Ù„Ø¨Ø§Ø¦Ø¹"),N(),o(null),u("")}catch(e){alert("Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ÙˆØ¶")}}),children:"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¹Ø±Ø¶ Ù„Ù„Ø¨Ø§Ø¦Ø¹"}),k.jsx("button",{className:"btn",style:{background:"#10b981",color:"white"},onClick:()=>B(r.id,s),children:"Ù…ÙˆØ§ÙÙ‚Ø© Ù…Ø¨Ø§Ø´Ø±Ø©"}),k.jsx("button",{className:"btn btn-secondary",onClick:()=>o(null),children:"Ø¥Ù„ØºØ§Ø¡"})]})]})}),g&&k.jsx(je,{images:g,initialIndex:f,onClose:()=>h(null)})]})}const Ee={title:{fontSize:"32px",color:"#10b981",marginBottom:"30px"},stats:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"20px",marginBottom:"40px"},statCard:{textAlign:"center",padding:"30px"},statNumber:{fontSize:"36px",color:"#10b981",marginBottom:"8px"},statLabel:{color:"#6b7280",fontSize:"16px"},section:{marginBottom:"40px"},subtitle:{fontSize:"24px",color:"#374151",marginBottom:"20px"},empty:{textAlign:"center",padding:"40px",color:"#6b7280"},productsList:{display:"flex",flexDirection:"column",gap:"24px"},productCard:{display:"flex",gap:"20px",flexWrap:"wrap"},productImages:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px",flex:"0 0 300px"},productImage:{width:"100%",height:"140px",objectFit:"cover",borderRadius:"8px",cursor:"pointer",transition:"transform 0.3s, box-shadow 0.3s"},productInfo:{flex:"1",minWidth:"300px"},productHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px",gap:"12px",flexWrap:"wrap"},productTitle:{fontSize:"20px",fontWeight:"600",color:"#1f2937",margin:0},statusBadge:{padding:"6px 14px",borderRadius:"20px",fontSize:"13px",fontWeight:"600",whiteSpace:"nowrap"},productDesc:{color:"#6b7280",marginBottom:"16px"},rejectionWarning:{background:"#fee2e2",border:"2px solid #dc2626",borderRadius:"8px",padding:"16px",marginBottom:"16px",color:"#991b1b",fontWeight:"600"},rejectionNote:{marginTop:"8px",fontSize:"14px",fontWeight:"normal",color:"#7f1d1d"},acceptanceNotice:{background:"#f0fdf4",border:"3px solid #10b981",borderRadius:"8px",padding:"16px",marginBottom:"16px",color:"#166534",fontWeight:"600"},agreedPrice:{fontSize:"20px",fontWeight:"bold",color:"#10b981"},noticeText:{marginTop:"8px",fontSize:"14px",fontWeight:"normal",color:"#166534"},productDetails:{background:"rgba(107, 124, 89, 0.1)",border:"1px solid rgba(107, 124, 89, 0.2)",padding:"16px",borderRadius:"8px",marginBottom:"16px"},detailRow:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},detailLabel:{fontWeight:"600",color:"#d1d5db"},priceHighlight:{fontSize:"18px",fontWeight:"bold",color:"#10b981"},discountBadge:{background:"#fef3c7",color:"#92400e",padding:"2px 8px",borderRadius:"8px",fontSize:"14px",fontWeight:"600"},sellerInfo:{background:"rgba(139, 115, 85, 0.1)",border:"1px solid rgba(139, 115, 85, 0.2)",padding:"16px",borderRadius:"8px",marginBottom:"16px"},sellerTitle:{fontSize:"16px",fontWeight:"600",marginBottom:"12px",color:"#f9fafb"},sellerData:{color:"#d1d5db",fontWeight:"500"},actions:{display:"flex",gap:"12px",flexWrap:"wrap"},recycleNote:{background:"rgba(107, 124, 89, 0.15)",padding:"16px",borderRadius:"8px",border:"2px solid rgba(107, 124, 89, 0.4)"},modal:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modalContent:{maxWidth:"500px",width:"90%"},modalTitle:{fontSize:"20px",marginBottom:"16px",color:"#10b981"},field:{marginTop:"16px",marginBottom:"16px"},label:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#374151"},modalActions:{display:"flex",gap:"12px",marginTop:"20px"}};function Pe(){const{profile:e}=ae(),t=h(),[i,n]=p.useState([]),[r,o]=p.useState(!1),[s,l]=p.useState(null),[x,u]=p.useState({title:"",description:"",image:"",discount_percentage:"",category:"",target_location:"",end_date:"",product_id:""}),[g,f]=p.useState(null),[m,y]=p.useState(null),[b,j]=p.useState(!1),[v,w]=p.useState([]);p.useEffect(()=>{"admin"===(null==e?void 0:e.role)?(_(),S()):t("/")},[e,t]);const S=()=>c(this,null,function*(){try{const{data:e,error:t}=yield le.from("products").select("id, title, price, status").eq("status","approved").order("created_at",{ascending:!1});if(t)throw t;w(e||[])}catch(e){}}),_=()=>c(this,null,function*(){try{const{data:e,error:t}=yield le.from("offers").select("*").order("created_at",{ascending:!1});if(t)throw t;n(e||[])}catch(e){}}),C=e=>c(this,null,function*(){try{const t=e.name.split(".").pop(),i=`offers/${Math.random().toString(36).substring(2)}-${Date.now()}.${t}`,{data:n,error:r}=yield le.storage.listBuckets();if(r)throw new Error("Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ØªØ®Ø²ÙŠÙ†");if(!(null==n?void 0:n.some(e=>"product-images"===e.name)))throw new Error("Ù…Ø³Ø§Ø­Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ† ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø·ÙˆØ±.");const{error:o}=yield le.storage.from("product-images").upload(i,e,{cacheControl:"3600",upsert:!1});if(o)throw o;const{data:{publicUrl:s}}=le.storage.from("product-images").getPublicUrl(i);return s}catch(t){throw t}}),N=e=>c(this,null,function*(){try{let t=le.from("profiles").select("id");e.target_location&&(t=t.eq("location",e.target_location));const{data:i}=yield t;if(i&&i.length>0){const t=i.map(t=>({user_id:t.id,message:`Ø¹Ø±Ø¶ Ø¬Ø¯ÙŠØ¯: ${e.title}`,type:"offer"}));yield le.from("notifications").insert(t)}}catch(t){}}),B=(e,t)=>c(this,null,function*(){try{const{data:i,error:n}=yield le.from("offers").update({is_active:!t}).eq("id",e).select();if(n)throw n;alert(t?"ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ù†Ø¬Ø§Ø­":"ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ù†Ø¬Ø§Ø­"),_()}catch(i){alert(`Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶: ${i.message}`)}}),z=e=>c(this,null,function*(){if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø±Ø¶ØŸ"))try{const{error:t}=yield le.from("offers").delete().eq("id",e);if(t)throw t;_()}catch(t){alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¹Ø±Ø¶")}});return k.jsxs("div",{className:"container",children:[k.jsxs("div",{style:Le.header,children:[k.jsx("h1",{style:Le.title,children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø±ÙˆØ¶"}),k.jsx("button",{className:"btn btn-primary",onClick:()=>{r?(o(!1),l(null),u({title:"",description:"",image:"",discount_percentage:"",category:"",target_location:"",end_date:"",product_id:""}),f(null),y(null)):o(!0)},children:r?"Ø¥Ù„ØºØ§Ø¡":"+ Ø¥Ø¶Ø§ÙØ© Ø¹Ø±Ø¶ Ø¬Ø¯ÙŠØ¯"})]}),r&&k.jsxs("div",{className:"card",style:Le.formCard,children:[k.jsx("h2",{style:Le.formTitle,children:s?"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶":"Ø¹Ø±Ø¶ Ø¬Ø¯ÙŠØ¯"}),k.jsxs("form",{onSubmit:t=>c(this,null,function*(){if(t.preventDefault(),x.title&&x.description)if(!x.discount_percentage||x.discount_percentage<=0)alert("ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ…");else{if(x.end_date&&new Date(x.end_date)<new Date)return void alert("Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø®ØªÙŠØ§Ø± ØªØ§Ø±ÙŠØ® ÙÙŠ Ø§Ù„Ù…Ø§Ø¶ÙŠ. ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØªØ§Ø±ÙŠØ® ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„.");j(!0);try{let t=x.image;if(g&&(t=yield C(g)),s){const{error:e}=yield le.from("offers").update({title:x.title,description:x.description,image:t,discount_percentage:x.discount_percentage?parseInt(x.discount_percentage):null,category:x.category||null,target_location:x.target_location||null,end_date:x.end_date||null,product_id:x.product_id||null}).eq("id",s.id);if(e)throw e;alert("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ù†Ø¬Ø§Ø­!")}else{const{data:i,error:n}=yield le.from("offers").insert(d(a({},x),{image:t,discount_percentage:x.discount_percentage?parseInt(x.discount_percentage):null,category:x.category||null,target_location:x.target_location||null,end_date:x.end_date||null,product_id:x.product_id||null,created_by:e.id})).select().single();if(n)throw n;yield N(i),alert("ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ù†Ø¬Ø§Ø­!")}o(!1),l(null),u({title:"",description:"",image:"",discount_percentage:"",category:"",target_location:"",end_date:"",product_id:""}),f(null),y(null),_()}catch(i){alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¹Ø±Ø¶: "+i.message)}finally{j(!1)}}else alert("ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„ÙˆØµÙ")}),children:[k.jsxs("div",{style:Le.field,children:[k.jsx("label",{style:Le.label,children:"Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø±Ø¶ *"}),k.jsx("input",{type:"text",className:"input",value:x.title,onChange:e=>u(d(a({},x),{title:e.target.value})),placeholder:"Ù…Ø«Ø§Ù„: Ø®ØµÙ… 50% Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø«Ø§Ø«",required:!0})]}),k.jsxs("div",{style:Le.field,children:[k.jsx("label",{style:Le.label,children:"ÙˆØµÙ Ø§Ù„Ø¹Ø±Ø¶ *"}),k.jsx("textarea",{className:"input",rows:"3",value:x.description,onChange:e=>u(d(a({},x),{description:e.target.value})),placeholder:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶...",required:!0})]}),k.jsxs("div",{style:Le.field,children:[k.jsx("label",{style:Le.label,children:"ØµÙˆØ±Ø© Ø§Ù„Ø¹Ø±Ø¶ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),k.jsx("input",{type:"file",className:"input",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t){if(t.size>5242880)return void alert("Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£Ù‚Ù„ Ù…Ù† 5 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª");f(t);const e=new FileReader;e.onloadend=()=>{y(e.result)},e.readAsDataURL(t)}},style:Le.fileInput}),m&&k.jsxs("div",{style:Le.imagePreviewContainer,children:[k.jsx("img",{src:m,alt:"Ù…Ø¹Ø§ÙŠÙ†Ø©",style:Le.imagePreview}),k.jsx("button",{type:"button",onClick:()=>{f(null),y(null)},style:Le.removeImageBtn,children:"âœ• Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØµÙˆØ±Ø©"})]})]}),k.jsxs("div",{style:Le.row,children:[k.jsxs("div",{style:Le.field,children:[k.jsx("label",{style:Le.label,children:"Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ… % *"}),k.jsx("input",{type:"number",className:"input",value:x.discount_percentage,onChange:e=>u(d(a({},x),{discount_percentage:e.target.value})),placeholder:"50",min:"1",max:"100",required:!0})]}),k.jsxs("div",{style:Le.field,children:[k.jsx("label",{style:Le.label,children:"Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),k.jsxs("select",{className:"input",value:x.category,onChange:e=>u(d(a({},x),{category:e.target.value})),children:[k.jsx("option",{value:"",children:"ÙƒÙ„ Ø§Ù„ÙØ¦Ø§Øª"}),k.jsx("option",{value:"furniture",children:"Ø£Ø«Ø§Ø«"}),k.jsx("option",{value:"clothes",children:"Ù…Ù„Ø§Ø¨Ø³"}),k.jsx("option",{value:"books",children:"ÙƒØªØ¨"}),k.jsx("option",{value:"toys",children:"Ø£Ù„Ø¹Ø§Ø¨"}),k.jsx("option",{value:"other",children:"Ø£Ø®Ø±Ù‰"})]})]})]}),k.jsxs("div",{style:Le.field,children:[k.jsx("label",{style:Le.label,children:"Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),k.jsx("input",{type:"text",className:"input",value:x.target_location,onChange:e=>u(d(a({},x),{target_location:e.target.value})),placeholder:"Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ù„ÙƒÙ„ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚"})]}),k.jsxs("div",{style:Le.field,children:[k.jsx("label",{style:Le.label,children:"Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),k.jsxs("select",{className:"input",value:x.product_id,onChange:e=>u(d(a({},x),{product_id:e.target.value})),children:[k.jsx("option",{value:"",children:"ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª"}),v.map(e=>k.jsxs("option",{value:e.id,children:[e.title," - ",e.price," Ø¬Ù†ÙŠÙ‡"]},e.id))]}),k.jsx("small",{style:{color:"#6b7280",fontSize:"13px",marginTop:"4px",display:"block"},children:"Ø§Ø®ØªØ± Ù…Ù†ØªØ¬ Ù…Ø¹ÙŠÙ† Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ø±Ø¶ Ø¹Ù„ÙŠÙ‡ØŒ Ø£Ùˆ Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ø±Ø¶ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª"})]}),k.jsxs("div",{style:Le.field,children:[k.jsx("label",{style:Le.label,children:"ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¹Ø±Ø¶ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),k.jsx("input",{type:"datetime-local",className:"input",value:x.end_date,onChange:e=>u(d(a({},x),{end_date:e.target.value})),min:(new Date).toISOString().slice(0,16)}),k.jsx("small",{style:{color:"#6b7280",fontSize:"13px",marginTop:"4px",display:"block"},children:"ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± ØªØ§Ø±ÙŠØ® ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„"})]}),k.jsx("button",{type:"submit",className:"btn btn-primary",style:Le.submitBtn,disabled:b,children:b?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...":s?"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª":"Ù†Ø´Ø± Ø§Ù„Ø¹Ø±Ø¶"})]})]}),k.jsx("div",{style:Le.offersList,children:0===i.length?k.jsx("div",{className:"card",style:Le.empty,children:k.jsx("p",{children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ø±ÙˆØ¶ Ø­Ø§Ù„ÙŠØ§Ù‹"})}):i.map(e=>{return k.jsxs("div",{className:"card",style:Le.offerCard,children:[e.image&&k.jsx("img",{src:e.image,alt:e.title,style:Le.offerImage}),k.jsxs("div",{style:Le.offerContent,children:[k.jsxs("div",{style:Le.offerHeader,children:[k.jsx("h3",{style:Le.offerTitle,children:e.title}),k.jsx("span",{style:d(a({},Le.statusBadge),{background:e.is_active?"#6b7c59":"#8b7355"}),children:e.is_active?"Ù†Ø´Ø·":"Ù…ØªÙˆÙ‚Ù"})]}),k.jsx("p",{style:Le.offerDesc,children:e.description}),k.jsxs("div",{style:Le.offerDetails,children:[e.discount_percentage&&k.jsxs("span",{style:Le.discountBadge,children:["Ø®ØµÙ… ",e.discount_percentage,"%"]}),e.category&&k.jsx("span",{style:Le.categoryBadge,children:(t=e.category,{furniture:"Ø£Ø«Ø§Ø«",clothes:"Ù…Ù„Ø§Ø¨Ø³",books:"ÙƒØªØ¨",toys:"Ø£Ù„Ø¹Ø§Ø¨",other:"Ø£Ø®Ø±Ù‰"}[t]||t)}),e.target_location&&k.jsx("span",{style:Le.locationBadge,children:e.target_location}),e.end_date&&k.jsxs("span",{style:Le.dateBadge,children:["ÙŠÙ†ØªÙ‡ÙŠ: ",new Date(e.end_date).toLocaleDateString("ar-EG")]})]}),k.jsxs("div",{style:Le.offerActions,children:[k.jsx("button",{className:"btn",style:{background:"#3b82f6",color:"white",borderRadius:"20px"},onClick:()=>(e=>{l(e),u({title:e.title,description:e.description,image:e.image||"",discount_percentage:e.discount_percentage||"",category:e.category||"",target_location:e.target_location||"",end_date:e.end_date?new Date(e.end_date).toISOString().slice(0,16):"",product_id:e.product_id||""}),y(e.image||null),o(!0)})(e),children:"ØªØ¹Ø¯ÙŠÙ„"}),k.jsx("button",{className:"btn",style:{background:e.is_active?"#8b7355":"#6b7c59",color:"white",borderRadius:"20px"},onClick:()=>B(e.id,e.is_active),children:e.is_active?"Ø¥ÙŠÙ‚Ø§Ù":"ØªÙØ¹ÙŠÙ„"}),k.jsx("button",{className:"btn btn-danger",onClick:()=>z(e.id),children:"Ø­Ø°Ù"})]})]})]},e.id);var t})})]})}const Le={header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px",flexWrap:"wrap",gap:"16px"},title:{fontSize:"32px",color:"#2d2d2d",margin:0,fontWeight:"600"},formCard:{marginBottom:"40px",padding:"32px"},formTitle:{fontSize:"24px",color:"#2d2d2d",marginBottom:"24px",fontWeight:"600"},field:{marginBottom:"20px",flex:1},row:{display:"flex",gap:"20px",flexWrap:"wrap"},label:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#5d5d5d",fontSize:"14px"},submitBtn:{width:"100%",padding:"12px"},offersList:{display:"flex",flexDirection:"column",gap:"20px"},empty:{textAlign:"center",padding:"60px 20px",color:"#6b7280"},offerCard:{display:"flex",gap:"24px",flexWrap:"wrap",padding:"24px"},offerImage:{width:"220px",height:"220px",objectFit:"cover",borderRadius:"16px",flexShrink:0},offerContent:{flex:1,minWidth:"300px"},offerHeader:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px",gap:"16px",flexWrap:"wrap"},offerTitle:{fontSize:"22px",fontWeight:"600",color:"#2d2d2d",margin:0,flex:"1",minWidth:"200px"},statusBadge:{padding:"8px 16px",borderRadius:"20px",color:"white",fontSize:"13px",fontWeight:"500",whiteSpace:"nowrap",flexShrink:0},offerDesc:{color:"#7a7a7a",marginBottom:"20px",lineHeight:"1.7",fontSize:"15px"},offerDetails:{display:"flex",gap:"12px",flexWrap:"wrap",marginBottom:"16px"},discountBadge:{background:"rgba(139, 115, 85, 0.1)",color:"#8b7355",padding:"8px 16px",borderRadius:"16px",fontSize:"14px",fontWeight:"600"},categoryBadge:{background:"rgba(107, 124, 89, 0.1)",color:"#556b2f",padding:"8px 16px",borderRadius:"16px",fontSize:"14px",fontWeight:"500"},locationBadge:{background:"rgba(107, 124, 89, 0.1)",color:"#556b2f",padding:"8px 16px",borderRadius:"16px",fontSize:"14px",fontWeight:"500"},dateBadge:{background:"rgba(139, 115, 85, 0.1)",color:"#8b7355",padding:"8px 16px",borderRadius:"16px",fontSize:"14px",fontWeight:"500"},offerActions:{display:"flex",gap:"12px"},fileInput:{padding:"12px",cursor:"pointer"},imagePreviewContainer:{marginTop:"16px",position:"relative",display:"inline-block"},imagePreview:{width:"200px",height:"200px",objectFit:"cover",borderRadius:"12px",border:"2px solid #e5e7eb"},removeImageBtn:{position:"absolute",top:"8px",right:"8px",background:"#ef4444",color:"white",border:"none",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",boxShadow:"0 2px 8px rgba(0,0,0,0.2)"}};function Ae(){const{profile:e}=ae(),t=h(),[i,n]=p.useState([]),[r,o]=p.useState(!0),[s,l]=p.useState(""),[x,u]=p.useState("all");p.useEffect(()=>{"admin"===(null==e?void 0:e.role)?g():t("/")},[e,t]);const g=()=>c(this,null,function*(){try{o(!0);const{data:e,error:t}=yield le.from("profiles").select("*").order("created_at",{ascending:!1});if(t)throw t;n(e||[])}catch(e){alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†")}finally{o(!1)}}),f=(e,t)=>c(this,null,function*(){const i="admin"===t?"user":"admin";if(confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØºÙŠÙŠØ± ØµÙ„Ø§Ø­ÙŠØ© Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ ${"admin"===i?"Ù…Ø¯ÙŠØ±":"Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø§Ø¯ÙŠ"}ØŸ`))try{const{error:t}=yield le.from("profiles").update({role:i}).eq("id",e);if(t)throw t;alert("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¨Ù†Ø¬Ø§Ø­"),g()}catch(n){alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª")}}),m=e=>c(this,null,function*(){if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ù…Ù†ØªØ¬Ø§ØªÙ‡ ÙˆØ¥Ø´Ø¹Ø§Ø±Ø§ØªÙ‡ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹."))try{const{error:t}=yield le.rpc("delete_user_completely",{user_id_to_delete:e});if(t){if(!t.message.includes("function")&&"42883"!==t.code)throw t;{yield le.from("notifications").delete().eq("user_id",e),yield le.from("products").delete().eq("user_id",e);const{error:t}=yield le.from("profiles").delete().eq("id",e);if(t)throw t;alert("ØªÙ… Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚. Ù„Ø­Ø°ÙÙ‡ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŒ Ù‚Ù… Ø¨ØªØ´ØºÙŠÙ„ migration-delete-user-function.sql ÙÙŠ Supabase")}}else alert("ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ù†Ø¬Ø§Ø­");g()}catch(t){alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: "+t.message)}}),y=i.filter(e=>{var t,i,n,r;const o=(null==(t=e.username)?void 0:t.toLowerCase().includes(s.toLowerCase()))||(null==(i=e.email)?void 0:i.toLowerCase().includes(s.toLowerCase()))||(null==(n=e.phone)?void 0:n.includes(s))||(null==(r=e.location)?void 0:r.toLowerCase().includes(s.toLowerCase())),l="all"===x||e.role===x;return o&&l});return r?k.jsx("div",{className:"container",children:k.jsx("div",{style:qe.loading,children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„..."})}):k.jsxs("div",{className:"container",children:[k.jsxs("div",{style:qe.header,children:[k.jsx("h1",{style:qe.title,children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†"}),k.jsxs("div",{style:qe.stats,children:[k.jsxs("div",{style:qe.statItem,children:[k.jsx("span",{style:qe.statNumber,children:i.length}),k.jsx("span",{style:qe.statLabel,children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†"})]}),k.jsxs("div",{style:qe.statItem,children:[k.jsx("span",{style:qe.statNumber,children:i.filter(e=>"admin"===e.role).length}),k.jsx("span",{style:qe.statLabel,children:"Ù…Ø¯Ø±Ø§Ø¡"})]}),k.jsxs("div",{style:qe.statItem,children:[k.jsx("span",{style:qe.statNumber,children:i.filter(e=>"user"===e.role).length}),k.jsx("span",{style:qe.statLabel,children:"Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†"})]})]})]}),k.jsx("div",{className:"card",style:qe.filterCard,children:k.jsxs("div",{style:qe.filterRow,children:[k.jsxs("div",{style:qe.searchBox,children:[k.jsxs("svg",{style:qe.searchIcon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[k.jsx("circle",{cx:"11",cy:"11",r:"8"}),k.jsx("path",{d:"m21 21-4.35-4.35"})]}),k.jsx("input",{type:"text",placeholder:"Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ø¨Ø±ÙŠØ¯ØŒ Ø§Ù„Ù‡Ø§ØªÙØŒ Ø£Ùˆ Ø§Ù„Ù…ÙˆÙ‚Ø¹...",value:s,onChange:e=>l(e.target.value),style:qe.searchInput,className:"input"})]}),k.jsxs("select",{value:x,onChange:e=>u(e.target.value),style:qe.filterSelect,className:"input",children:[k.jsx("option",{value:"all",children:"ÙƒÙ„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª"}),k.jsx("option",{value:"admin",children:"Ù…Ø¯Ø±Ø§Ø¡ ÙÙ‚Ø·"}),k.jsx("option",{value:"user",children:"Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙÙ‚Ø·"})]})]})}),k.jsx("div",{style:qe.usersList,children:0===y.length?k.jsx("div",{className:"card",style:qe.empty,children:k.jsx("p",{children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬"})}):y.map(i=>k.jsxs("div",{className:"card",style:qe.userCard,children:[k.jsx("div",{style:qe.userHeader,children:k.jsxs("div",{style:qe.userInfo,children:[k.jsx("h3",{style:qe.userName,children:i.username}),k.jsx("span",{style:d(a({},qe.roleBadge),{background:"admin"===i.role?"#6b7c59":"#8b7355"}),children:"admin"===i.role?"Ù…Ø¯ÙŠØ±":"Ù…Ø³ØªØ®Ø¯Ù…"})]})}),k.jsxs("div",{style:qe.userDetails,children:[k.jsxs("div",{style:qe.detailRow,children:[k.jsx("span",{style:qe.detailLabel,children:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:"}),k.jsx("span",{style:qe.detailValue,children:i.email})]}),k.jsxs("div",{style:qe.detailRow,children:[k.jsx("span",{style:qe.detailLabel,children:"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:"}),k.jsx("span",{style:qe.detailValue,children:i.phone||"ØºÙŠØ± Ù…ØªÙˆÙØ±"})]}),k.jsxs("div",{style:qe.detailRow,children:[k.jsx("span",{style:qe.detailLabel,children:"Ø§Ù„Ù…ÙˆÙ‚Ø¹:"}),k.jsx("span",{style:qe.detailValue,children:i.location||"ØºÙŠØ± Ù…ØªÙˆÙØ±"})]}),k.jsxs("div",{style:qe.detailRow,children:[k.jsx("span",{style:qe.detailLabel,children:"ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„:"}),k.jsx("span",{style:qe.detailValue,children:new Date(i.created_at).toLocaleDateString("ar-EG")})]})]}),k.jsxs("div",{style:qe.userActions,children:[k.jsx("button",{className:"btn",style:{background:"admin"===i.role?"#8b7355":"#6b7c59",color:"white",borderRadius:"20px"},onClick:()=>f(i.id,i.role),disabled:i.id===e.id,children:"admin"===i.role?"Ø¥Ø²Ø§Ù„Ø© ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…Ø¯ÙŠØ±":"Ø¬Ø¹Ù„Ù‡ Ù…Ø¯ÙŠØ±"}),k.jsx("button",{className:"btn",style:{background:"#3b82f6",color:"white",borderRadius:"20px"},onClick:()=>t(`/profile/${i.id}`),children:"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª"}),k.jsx("button",{className:"btn btn-danger",onClick:()=>m(i.id),disabled:i.id===e.id,children:"Ø­Ø°Ù"})]})]},i.id))})]})}const qe={header:{marginBottom:"32px"},title:{fontSize:"32px",color:"#000000",marginBottom:"24px",fontWeight:"600"},stats:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"20px",marginBottom:"24px"},statItem:{background:"linear-gradient(135deg, rgba(107, 124, 89, 0.1) 0%, rgba(139, 115, 85, 0.1) 100%)",padding:"24px",borderRadius:"20px",textAlign:"center",border:"1px solid rgba(107, 124, 89, 0.2)"},statNumber:{display:"block",fontSize:"36px",fontWeight:"700",color:"#6b7c59",marginBottom:"8px"},statLabel:{display:"block",fontSize:"14px",color:"#000000",fontWeight:"600"},filterCard:{marginBottom:"32px",padding:"24px"},filterRow:{display:"flex",gap:"16px",flexWrap:"wrap"},searchBox:{flex:"1",minWidth:"300px",position:"relative",display:"flex",alignItems:"center"},searchIcon:{position:"absolute",right:"16px",color:"#9ca3af",pointerEvents:"none"},searchInput:{width:"100%",paddingRight:"48px"},filterSelect:{minWidth:"200px"},loading:{textAlign:"center",padding:"60px",fontSize:"18px",color:"#7a7a7a"},empty:{textAlign:"center",padding:"60px",color:"#7a7a7a"},usersList:{display:"flex",flexDirection:"column",gap:"20px"},userCard:{padding:"24px",transition:"all 0.3s ease"},userHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"16px",borderBottom:"1px solid rgba(107, 124, 89, 0.1)"},userInfo:{display:"flex",alignItems:"center",gap:"16px",flexWrap:"wrap"},userName:{fontSize:"22px",fontWeight:"600",color:"#000000",margin:0},roleBadge:{padding:"8px 16px",borderRadius:"20px",color:"white",fontSize:"13px",fontWeight:"500"},userDetails:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px",marginBottom:"20px"},detailRow:{display:"flex",flexDirection:"column",gap:"6px"},detailLabel:{fontSize:"13px",color:"#000000",fontWeight:"600"},detailValue:{fontSize:"15px",color:"#000000",fontWeight:"600"},userActions:{display:"flex",gap:"12px",flexWrap:"wrap",paddingTop:"16px",borderTop:"1px solid rgba(107, 124, 89, 0.1)"}};function $e(){const{profile:e}=ae(),[t,i]=p.useState([]),n=h();p.useEffect(()=>{o();const t=le.channel("notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${e.id}`},e=>{i(t=>[e.new,...t]),r()}).subscribe();return()=>{le.removeChannel(t)}},[]);const r=()=>{try{new Audio("/notification-sound.mp3").play().catch(e=>{})}catch(e){}},o=()=>c(this,null,function*(){try{const{data:t,error:n}=yield le.from("notifications").select("*, products(title, images, final_price)").eq("user_id",e.id).order("created_at",{ascending:!1}).limit(50);if(n)throw n;i(t||[])}catch(t){}}),s=e=>c(this,null,function*(){try{const{error:t}=yield le.from("notifications").update({read:!0}).eq("id",e);if(t)throw t;i(t=>t.map(t=>t.id===e?d(a({},t),{read:!0}):t)),window.dispatchEvent(new Event("notificationsUpdated"))}catch(t){}}),l=e=>{const t=new Date-new Date(e),i=Math.floor(t/6e4),n=Math.floor(t/36e5),r=Math.floor(t/864e5);return i<1?"Ø§Ù„Ø¢Ù†":i<60?`Ù…Ù†Ø° ${i} Ø¯Ù‚ÙŠÙ‚Ø©`:n<24?`Ù…Ù†Ø° ${n} Ø³Ø§Ø¹Ø©`:`Ù…Ù†Ø° ${r} ÙŠÙˆÙ…`},x=t.filter(e=>!e.read).length;return k.jsxs("div",{className:"container",children:[k.jsxs("div",{style:Oe.header,children:[k.jsx("h1",{style:Oe.title,children:"Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª"}),x>0&&k.jsxs("button",{className:"btn",onClick:()=>c(this,null,function*(){try{const{error:t}=yield le.from("notifications").update({read:!0}).eq("user_id",e.id).eq("read",!1);if(t)throw t;i(e=>e.map(e=>d(a({},e),{read:!0}))),window.dispatchEvent(new Event("notificationsUpdated")),alert("ØªÙ… ØªØ¹Ù„ÙŠÙ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙƒÙ…Ù‚Ø±ÙˆØ¡Ø© âœ“")}catch(t){alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª")}}),style:Oe.markAllBtn,children:["ØªØ¹Ù„ÙŠÙ… Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡ (",x,")"]})]}),0===t.length?k.jsx("div",{className:"card",style:Oe.empty,children:k.jsx("p",{children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª"})}):k.jsx("div",{style:Oe.notificationsList,children:t.map(e=>k.jsx("div",{className:"card",style:a(a({},Oe.notificationCard),e.read?{}:Oe.unreadCard),onClick:()=>(e=>{s(e.id),e.product_id&&n(`/product/${e.product_id}`)})(e),children:k.jsxs("div",{style:Oe.notificationContent,children:[k.jsx("div",{style:Oe.iconContainer,children:k.jsx("span",{style:Oe.icon,children:(e.type,"â€¢")})}),k.jsxs("div",{style:Oe.notificationBody,children:[k.jsx("p",{style:Oe.message,children:e.message}),e.products&&k.jsxs("div",{style:Oe.productPreview,children:[e.products.images&&e.products.images[0]&&k.jsx("img",{src:e.products.images[0],alt:e.products.title,style:Oe.productImage}),k.jsxs("div",{children:[k.jsx("p",{style:Oe.productTitle,children:e.products.title}),e.products.final_price&&k.jsxs("p",{style:Oe.productPrice,children:[e.products.final_price," Ø¬Ù†ÙŠÙ‡"]})]})]}),k.jsx("span",{style:Oe.time,children:l(e.created_at)})]}),!e.read&&k.jsx("div",{style:Oe.unreadDot})]})},e.id))})]})}const Oe={header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px",flexWrap:"wrap",gap:"16px"},title:{fontSize:"32px",color:"#10b981",margin:0},markAllBtn:{fontSize:"14px",background:"#10b981",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:"pointer",fontWeight:"600",transition:"all 0.3s",whiteSpace:"nowrap"},empty:{textAlign:"center",padding:"60px 20px",color:"#6b7280"},notificationsList:{display:"flex",flexDirection:"column",gap:"12px"},notificationCard:{cursor:"pointer",transition:"transform 0.2s, box-shadow 0.2s",position:"relative"},unreadCard:{background:"#f0fdf4",borderLeft:"4px solid #10b981"},notificationContent:{display:"flex",gap:"16px",alignItems:"flex-start"},iconContainer:{flex:"0 0 50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",borderRadius:"50%"},icon:{fontSize:"24px"},notificationBody:{flex:"1"},message:{fontSize:"16px",color:"#1f2937",marginBottom:"8px",lineHeight:"1.5"},productPreview:{display:"flex",gap:"12px",alignItems:"center",padding:"12px",background:"rgba(107, 124, 89, 0.1)",border:"1px solid rgba(107, 124, 89, 0.2)",borderRadius:"8px",marginBottom:"8px"},productImage:{width:"60px",height:"60px",objectFit:"cover",borderRadius:"6px"},productTitle:{fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"4px"},productPrice:{fontSize:"14px",color:"#10b981",fontWeight:"600"},time:{fontSize:"12px",color:"#9ca3af"},unreadDot:{width:"10px",height:"10px",background:"#10b981",borderRadius:"50%",position:"absolute",top:"24px",right:"24px"}};function Fe(){const{id:e}=m(),t=h(),{profile:i}=ae(),{approveProduct:n,rejectProduct:r,negotiateProduct:o}=be(),[s,l]=p.useState(null),[x,u]=p.useState(null),[g,f]=p.useState(null),[y,b]=p.useState(!1),[j,v]=p.useState(0),[w,S]=p.useState(!1),[_,C]=p.useState(""),[N,B]=p.useState("");p.useEffect(()=>{z()},[e]);const z=()=>c(this,null,function*(){try{const{data:t,error:n}=yield le.from("products").select("*").eq("id",e).single();if(n)throw n;const{data:r}=yield le.from("offers").select("*").eq("is_active",!0).eq("category",t.category);let o,s=null;if(r&&r.length>0&&(s=r.find(e=>e.discount_percentage&&(!e.end_date||new Date(e.end_date)>new Date))),f(s),"admin"===(null==i?void 0:i.role)){const{data:e,error:i}=yield le.from("profiles").select("username, phone, location, email").eq("id",t.user_id).single();if(i)throw i;o=e}else{const{data:e,error:t}=yield le.from("profiles").select("username, phone, location, email").eq("role","admin").limit(1).single();if(t)throw t;o=e}l(t),u(o)}catch(t){alert("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬")}}),I=e=>{v(e),b(!0)},W=e=>c(this,null,function*(){if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ"))try{yield n(s.id,e),alert("ØªÙ… Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬"),t("/admin")}catch(i){alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬")}}),T=e=>({pending:"#f59e0b",approved:"#10b981",rejected:"#ef4444",awaiting_seller:"#3b82f6"}[e]||"#6b7280");return s?k.jsxs("div",{className:"container",children:[k.jsx("button",{className:"btn",onClick:()=>t(-1),style:He.backBtn,children:"â† Ø±Ø¬ÙˆØ¹"}),k.jsxs("div",{className:"card",style:He.productCard,children:[s.images&&s.images.length>0&&k.jsxs("div",{style:He.imageGallery,children:[k.jsx("div",{style:He.mainImage,children:k.jsx("img",{src:s.images[0],alt:s.title,style:He.mainImg,onClick:()=>I(0),loading:"lazy",onError:e=>{e.target.src="https://placehold.co/400x300/e2e8f0/64748b?text=Main+Image+Not+Found"}})}),s.images.length>1&&k.jsx("div",{style:He.thumbnails,children:s.images.map((e,t)=>k.jsx("img",{src:e,alt:`${s.title} ${t+1}`,style:He.thumbnail,onClick:()=>I(t),loading:"lazy",onError:e=>{e.target.src="https://placehold.co/100x100/e2e8f0/64748b?text=Thumb+Not+Found"}},t))})]}),k.jsxs("div",{style:He.details,children:[k.jsxs("div",{style:He.header,children:[k.jsx("h1",{style:He.title,children:s.title}),k.jsx("span",{style:d(a({},He.status),{background:T(s.status)+"20",color:T(s.status)}),children:(R=s.status,{pending:"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©",approved:"Ù…ØªØ§Ø­ Ù„Ù„Ø¨ÙŠØ¹",rejected:"Ù…Ø±ÙÙˆØ¶",awaiting_seller:"ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø¨Ø§Ø¦Ø¹"}[R]||R)})]}),k.jsx("p",{className:"product-description",children:s.description}),k.jsx("div",{style:He.priceSection,children:"recycle"===s.choice_type?k.jsxs("div",{style:He.recycleBox,children:[k.jsx("h3",{style:He.recycleTitle,children:"Ø¥Ø¹Ø§Ø¯Ø© ØªØ¯ÙˆÙŠØ±"}),s.recycle_idea&&k.jsx("p",{style:He.recycleIdea,children:s.recycle_idea})]}):k.jsx(k.Fragment,{children:g&&s.final_price?k.jsxs("div",{style:He.offerPriceBox,children:[k.jsxs("div",{style:He.offerBanner,children:["Ø¹Ø±Ø¶ Ø®Ø§Øµ: Ø®ØµÙ… ",g.discount_percentage,"%"]}),k.jsx("div",{style:He.offerTitle,children:g.title}),g.description&&k.jsx("p",{style:He.offerDesc,children:g.description}),k.jsxs("div",{style:He.priceComparison,children:[k.jsxs("div",{style:He.oldPriceBox,children:[k.jsx("span",{style:He.priceLabel,children:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£ØµÙ„ÙŠ:"}),k.jsxs("span",{style:He.oldPriceValue,children:[s.final_price," Ø¬Ù†ÙŠÙ‡"]})]}),k.jsxs("div",{style:He.newPriceBox,children:[k.jsx("span",{style:He.priceLabel,children:"Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…:"}),k.jsxs("span",{style:He.newPriceValue,children:[Math.round(s.final_price*(1-g.discount_percentage/100))," Ø¬Ù†ÙŠÙ‡"]})]})]}),k.jsxs("div",{style:He.savings,children:["ÙˆÙØ± ",Math.round(s.final_price*(g.discount_percentage/100))," Ø¬Ù†ÙŠÙ‡!"]}),g.end_date&&k.jsxs("div",{style:He.offerEndDate,children:["â° Ø§Ù„Ø¹Ø±Ø¶ ÙŠÙ†ØªÙ‡ÙŠ: ",new Date(g.end_date).toLocaleDateString("ar-EG")]})]}):s.final_price?k.jsxs("div",{style:He.priceBox,children:[k.jsx("span",{style:He.priceLabel,className:"price-label",children:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:"}),k.jsxs("span",{style:He.finalPrice,children:[s.final_price," Ø¬Ù†ÙŠÙ‡"]})]}):s.negotiated_price?k.jsxs("div",{style:He.priceBox,children:[k.jsx("span",{style:He.priceLabel,children:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­:"}),k.jsxs("span",{style:He.negotiatedPrice,children:[s.negotiated_price," Ø¬Ù†ÙŠÙ‡"]})]}):k.jsxs("div",{style:He.priceBox,children:[k.jsx("span",{style:He.priceLabel,children:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­:"}),k.jsxs("span",{style:He.suggestedPrice,children:[s.suggested_price," Ø¬Ù†ÙŠÙ‡"]})]})})}),k.jsxs("div",{style:He.infoGrid,children:[k.jsxs("div",{style:He.infoItem,children:[k.jsx("span",{className:"info-label",children:"Ø§Ù„Ø­Ø§Ù„Ø©:"}),k.jsx("span",{className:"info-value",children:s.condition})]}),k.jsxs("div",{style:He.infoItem,children:[k.jsx("span",{className:"info-label",children:"Ø§Ù„ÙØ¦Ø©:"}),k.jsxs("span",{className:"info-value",children:["furniture"===s.category&&"Ø£Ø«Ø§Ø«","clothes"===s.category&&"Ù…Ù„Ø§Ø¨Ø³","books"===s.category&&"ÙƒØªØ¨","toys"===s.category&&"Ø£Ù„Ø¹Ø§Ø¨","other"===s.category&&"Ø£Ø®Ø±Ù‰"]})]}),s.original_price&&k.jsxs("div",{style:He.infoItem,children:[k.jsx("span",{style:He.infoLabel,children:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£ØµÙ„ÙŠ:"}),k.jsxs("span",{style:He.infoValue,children:[s.original_price," Ø¬Ù†ÙŠÙ‡"]})]}),s.discount_percentage&&k.jsxs("div",{style:He.infoItem,children:[k.jsx("span",{style:He.infoLabel,children:"Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ…:"}),k.jsxs("span",{style:He.infoValue,children:[s.discount_percentage,"%"]})]})]}),x&&k.jsxs("div",{style:He.sellerSection,children:[k.jsx("h3",{className:"section-title",children:"admin"===(null==i?void 0:i.role)?"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨Ø§Ø¦Ø¹":"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ (Ø¨ÙŠÙƒÙŠØ§)"}),k.jsxs("div",{style:He.sellerInfo,children:[k.jsxs("div",{style:He.sellerItem,children:[k.jsx("span",{className:"seller-label",children:"Ø§Ù„Ø§Ø³Ù…:"}),k.jsx("span",{className:"seller-value",children:x.username})]}),k.jsxs("div",{style:He.sellerItem,children:[k.jsx("span",{className:"seller-label",children:"Ø§Ù„Ù…ÙˆÙ‚Ø¹:"}),k.jsx("span",{className:"seller-value",children:x.location})]}),"approved"===s.status&&k.jsxs(k.Fragment,{children:[k.jsxs("div",{style:He.sellerItem,children:[k.jsx("span",{className:"seller-label",children:"ðŸ“ž Ø§Ù„Ù‡Ø§ØªÙ:"}),k.jsx("span",{className:"seller-value",children:x.phone})]}),k.jsxs("div",{style:He.sellerItem,children:[k.jsx("span",{className:"seller-label",children:"ðŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯:"}),k.jsx("span",{className:"seller-value",children:x.email})]})]})]})]}),s.negotiation_note&&k.jsxs("div",{style:He.noteSection,children:[k.jsx("h3",{className:"section-title",children:"Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©"}),k.jsx("p",{style:He.note,children:s.negotiation_note})]}),s.rejection_reason&&k.jsxs("div",{style:He.rejectionSection,children:[k.jsx("h3",{className:"section-title",children:"Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶"}),k.jsx("p",{style:He.rejection,children:s.rejection_reason})]}),"admin"===(null==i?void 0:i.role)&&"pending"===s.status&&"sell"===s.choice_type&&k.jsxs("div",{style:He.adminActions,children:[k.jsx("h3",{className:"section-title",children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©"}),k.jsxs("div",{style:He.actionButtons,children:[k.jsxs("button",{className:"btn btn-primary",onClick:()=>W(s.suggested_price),style:He.actionBtn,children:["Ù…ÙˆØ§ÙÙ‚Ø© (",s.suggested_price," Ø¬Ù†ÙŠÙ‡)"]}),k.jsx("button",{className:"btn btn-secondary",onClick:()=>{C(s.suggested_price||s.negotiated_price||""),B(""),S(!0)},style:He.actionBtn,children:"ØªÙØ§ÙˆØ¶"}),k.jsx("button",{className:"btn btn-danger",onClick:()=>c(this,null,function*(){const e=prompt("Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶:");if(e)try{yield r(s.id,e),alert("ØªÙ… Ø±ÙØ¶ Ø§Ù„Ù…Ù†ØªØ¬"),t("/admin")}catch(i){alert("Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¶ Ø§Ù„Ù…Ù†ØªØ¬")}}),style:He.actionBtn,children:"Ø±ÙØ¶"})]})]})]})]}),w&&k.jsx("div",{style:He.modal,children:k.jsxs("div",{className:"card",style:He.modalContent,children:[k.jsx("h3",{style:He.modalTitle,children:"Ø§Ù„ØªÙØ§ÙˆØ¶ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¹Ø±"}),k.jsxs("p",{children:["Ø§Ù„Ù…Ù†ØªØ¬: ",s.title]}),k.jsxs("p",{children:["Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­: ",s.suggested_price," Ø¬Ù†ÙŠÙ‡"]}),k.jsxs("div",{style:He.field,children:[k.jsx("label",{style:He.label,children:"Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯:"}),k.jsx("input",{type:"number",className:"input",value:_,onChange:e=>C(e.target.value),max:"500",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨"})]}),k.jsxs("div",{style:He.field,children:[k.jsx("label",{style:He.label,children:"Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„Ø¨Ø§Ø¦Ø¹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):"}),k.jsx("textarea",{className:"input",rows:"3",value:N,onChange:e=>B(e.target.value),placeholder:"Ù…Ø«Ø§Ù„: Ø§Ù„Ø³Ø¹Ø± Ù…Ø±ØªÙØ¹ Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ø¨Ø³Ø¨Ø¨ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù†ØªØ¬"})]}),k.jsxs("div",{style:He.modalActions,children:[k.jsx("button",{className:"btn btn-primary",onClick:()=>c(this,null,function*(){if(!_||_<=0)alert("ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø³Ø¹Ø± ØµØ­ÙŠØ­");else try{yield o(s.id,_,N),alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ÙˆØ¶ Ù„Ù„Ø¨Ø§Ø¦Ø¹"),S(!1),z()}catch(e){alert("Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ÙˆØ¶")}}),children:"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¹Ø±Ø¶ Ù„Ù„Ø¨Ø§Ø¦Ø¹"}),k.jsx("button",{className:"btn",style:{background:"#10b981",color:"white"},onClick:()=>{S(!1),W(_)},children:"Ù…ÙˆØ§ÙÙ‚Ø© Ù…Ø¨Ø§Ø´Ø±Ø©"}),k.jsx("button",{className:"btn btn-secondary",onClick:()=>S(!1),children:"Ø¥Ù„ØºØ§Ø¡"})]})]})}),y&&s.images&&k.jsx(je,{images:s.images,currentIndex:j,onClose:()=>b(!1),onNext:()=>v((j+1)%s.images.length),onPrev:()=>v((j-1+s.images.length)%s.images.length)})]}):k.jsx("div",{className:"container",children:k.jsxs("div",{className:"card",style:He.error,children:[k.jsx("h2",{children:"Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯"}),k.jsx("button",{className:"btn btn-primary",onClick:()=>t("/"),children:"Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"})]})});var R}const He={backBtn:{marginBottom:"20px"},productCard:{maxWidth:"1000px",margin:"0 auto",padding:"40px"},imageGallery:{marginBottom:"30px"},mainImage:{width:"100%",height:"500px",marginBottom:"24px",borderRadius:"24px",overflow:"hidden",cursor:"pointer",background:"#f5f5f0"},mainImg:{width:"100%",height:"100%",objectFit:"cover"},thumbnails:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"16px"},thumbnail:{width:"100%",height:"120px",objectFit:"cover",borderRadius:"16px",cursor:"pointer",border:"2px solid transparent",transition:"all 0.3s ease",background:"#f5f5f0"},details:{display:"flex",flexDirection:"column",gap:"32px"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"16px",flexWrap:"wrap"},title:{fontSize:"36px",fontWeight:"600",color:"#2d2d2d",margin:0,lineHeight:"1.3"},status:{padding:"10px 20px",borderRadius:"24px",fontSize:"14px",fontWeight:"500"},priceSection:{padding:"32px",background:"rgba(107, 124, 89, 0.05)",borderRadius:"24px",border:"1px solid rgba(107, 124, 89, 0.1)"},priceBox:{display:"flex",justifyContent:"space-between",alignItems:"center"},priceLabel:{fontSize:"18px",color:"#000000",fontWeight:"600"},finalPrice:{fontSize:"32px",fontWeight:"600",color:"#6b7c59"},negotiatedPrice:{fontSize:"28px",fontWeight:"600",color:"#8b7355"},suggestedPrice:{fontSize:"28px",fontWeight:"600",color:"#8b7355"},recycleBox:{textAlign:"center",padding:"20px"},recycleTitle:{fontSize:"26px",color:"#6b7c59",marginBottom:"16px",fontWeight:"600"},recycleIdea:{fontSize:"16px",color:"#7a7a7a",lineHeight:"1.8"},offerPriceBox:{background:"rgba(139, 115, 85, 0.08)",padding:"28px",borderRadius:"24px",border:"2px solid rgba(139, 115, 85, 0.2)"},offerBanner:{background:"#8b7355",color:"white",padding:"12px 24px",borderRadius:"20px",fontSize:"17px",fontWeight:"600",textAlign:"center",marginBottom:"16px"},offerTitle:{fontSize:"20px",fontWeight:"600",color:"#5d5d5d",marginBottom:"8px",textAlign:"center"},offerDesc:{fontSize:"14px",color:"#7a7a7a",marginBottom:"16px",textAlign:"center"},priceComparison:{display:"flex",justifyContent:"space-around",gap:"20px",marginBottom:"16px",flexWrap:"wrap"},oldPriceBox:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},oldPriceValue:{fontSize:"20px",color:"#9ca3af",textDecoration:"line-through",fontWeight:"600"},newPriceBox:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},newPriceValue:{fontSize:"32px",fontWeight:"600",color:"#6b7c59"},savings:{background:"#6b7c59",color:"white",padding:"14px",borderRadius:"16px",textAlign:"center",fontSize:"17px",fontWeight:"600",marginBottom:"12px"},offerEndDate:{textAlign:"center",fontSize:"14px",color:"#92400e",fontWeight:"600"},infoGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},infoItem:{padding:"20px",background:"rgba(107, 124, 89, 0.15)",borderRadius:"20px",display:"flex",flexDirection:"column",gap:"10px",border:"1px solid rgba(107, 124, 89, 0.2)"},infoLabel:{fontSize:"13px",color:"#000000",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px"},infoValue:{fontSize:"17px",color:"#000000",fontWeight:"600"},sellerSection:{padding:"28px",background:"rgba(107, 124, 89, 0.15)",borderRadius:"24px",border:"1px solid rgba(107, 124, 89, 0.25)"},sellerInfo:{display:"flex",flexDirection:"column",gap:"12px"},sellerItem:{display:"flex",justifyContent:"space-between",padding:"14px",background:"rgba(255, 255, 255, 0.8)",borderRadius:"16px"},noteSection:{padding:"28px",background:"rgba(139, 115, 85, 0.06)",borderRadius:"24px",border:"1px solid rgba(139, 115, 85, 0.15)"},note:{fontSize:"16px",color:"#5d5d5d",lineHeight:"1.7"},rejectionSection:{padding:"20px",background:"#fee2e2",borderRadius:"12px",border:"2px solid #ef4444"},rejection:{fontSize:"16px",color:"#991b1b",lineHeight:"1.6"},adminActions:{padding:"28px",background:"rgba(107, 124, 89, 0.08)",borderRadius:"24px",border:"1px solid rgba(107, 124, 89, 0.2)"},actionButtons:{display:"flex",gap:"12px",flexWrap:"wrap",marginTop:"16px"},actionBtn:{flex:"1",minWidth:"150px"},modal:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modalContent:{maxWidth:"500px",width:"90%",maxHeight:"90vh",overflow:"auto"},modalTitle:{fontSize:"22px",marginBottom:"20px",color:"#2d2d2d",fontWeight:"600"},field:{marginTop:"16px",marginBottom:"16px"},label:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#374151"},modalActions:{display:"flex",gap:"12px",marginTop:"20px",flexWrap:"wrap"},error:{textAlign:"center",padding:"60px 20px"}};function Me(){const{user:e}=ae(),[t,i]=p.useState("checking"),[n,r]=p.useState("");return p.useEffect(()=>{(()=>{c(this,null,function*(){if(!e)return i("error"),void r("ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹");try{i("updating"),r("Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª...");const{data:t,error:n}=yield le.from("profiles").update({role:"admin"}).eq("id",e.id).select();if(n)return i("error"),void r(`Ø®Ø·Ø£: ${n.message}`);i("success"),r("ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙƒÙ…Ø¯ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­! Ø³ÙŠØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡Ùƒ..."),setTimeout(()=>{window.location.href="/admin"},2e3)}catch(t){i("error"),r(`Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹: ${t.message}`)}})})()},[e]),k.jsx("div",{className:"container",style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:k.jsxs("div",{className:"card",style:a({padding:"40px",textAlign:"center",maxWidth:"500px"},(()=>{switch(t){case"success":return{color:"#10b981",background:"#f0fdf4"};case"error":return{color:"#ef4444",background:"#fee2e2"};case"updating":return{color:"#f59e0b",background:"#fef3c7"};default:return{color:"#6b7280",background:"#f3f4f6"}}})()),children:[k.jsxs("h2",{style:{marginBottom:"16px"},children:["checking"===t&&"Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª","updating"===t&&"ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª","success"===t&&"ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­","error"===t&&"Ø­Ø¯Ø« Ø®Ø·Ø£"]}),k.jsx("p",{style:{fontSize:"18px",marginBottom:"24px"},children:n}),"error"===t&&k.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[k.jsx("button",{className:"btn btn-primary",onClick:()=>window.location.reload(),children:"Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©"}),k.jsx("button",{className:"btn btn-secondary",onClick:()=>window.location.href="/",children:"Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"})]})]})})}function Ue(){const{profile:e,signOut:t}=ae(),i=h(),[n,r]=p.useState(0),[o,s]=p.useState(!1);p.useEffect(()=>{},[e]),p.useEffect(()=>{if(null==e?void 0:e.id){"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission(),l();const t=le.channel("notifications-changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${e.id}`},e=>{var t;d();const i=(null==(t=e.new)?void 0:t.message)||"Ù„Ø¯ÙŠÙƒ Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯!";a(i),l()}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"notifications",filter:`user_id=eq.${e.id}`},e=>{l()}).subscribe(),i=()=>{l()};return window.addEventListener("notificationsUpdated",i),()=>{t.unsubscribe(),window.removeEventListener("notificationsUpdated",i)}}},[e]);const l=()=>c(this,null,function*(){if(null==e?void 0:e.id)try{const{count:t,error:i}=yield le.from("notifications").select("*",{count:"exact",head:!0}).eq("user_id",e.id).eq("read",!1);i||r(t||0)}catch(t){}}),a=(e="Ù„Ø¯ÙŠÙƒ Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯! Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ Ù…ØªØ§Ø­ ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙƒ")=>{"Notification"in window&&"granted"===Notification.permission&&new Notification("Ø¨ÙŠÙƒÙŠØ§ - Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯",{body:e,icon:"/favicon.ico",badge:"/favicon.ico",tag:"bekya-notification",requireInteraction:!1})},d=()=>{try{const e=new Audio("/notification.mp3");e.volume=.5,e.play().catch(()=>{x()})}catch(e){x()}},x=()=>{try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.connect(i),i.connect(e.destination),t.frequency.value=800,t.type="sine",i.gain.setValueAtTime(.3,e.currentTime),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.15),t.start(e.currentTime),t.stop(e.currentTime+.15),setTimeout(()=>{const t=e.createOscillator(),i=e.createGain();t.connect(i),i.connect(e.destination),t.frequency.value=1e3,t.type="sine",i.gain.setValueAtTime(.3,e.currentTime),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.15),t.start(e.currentTime),t.stop(e.currentTime+.15)},100)}catch(e){}};return k.jsx("nav",{style:Ge.nav,children:k.jsxs("div",{className:"container",style:Ge.container,children:[k.jsx(f,{to:"/",style:Ge.logo,children:"Ø¨ÙŠÙƒÙŠØ§"}),k.jsxs("div",{style:Ge.rightSection,children:[k.jsxs(f,{to:"/notifications",style:Ge.notificationLink,children:[k.jsxs("svg",{style:Ge.bellIcon,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[k.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),k.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),n>0&&k.jsx("span",{style:Ge.badge,children:n})]}),k.jsx("button",{onClick:()=>{s(!o)},className:"navbar-hamburger",style:Ge.hamburger,"aria-label":"Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©",children:o?"âœ•":"â˜°"})]}),k.jsxs("div",{className:"navbar-menu "+(o?"menu-open":"menu-closed"),style:Ge.menu,children:[k.jsx(f,{to:"/",style:Ge.link,onClick:()=>s(!1),children:"Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"}),k.jsx(f,{to:"/add-product",style:Ge.link,onClick:()=>s(!1),children:"Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬"}),k.jsx(f,{to:"/profile",style:Ge.link,onClick:()=>s(!1),children:"Ø­Ø³Ø§Ø¨ÙŠ"}),"admin"===(null==e?void 0:e.role)&&k.jsxs(k.Fragment,{children:[k.jsx(f,{to:"/admin",style:Ge.link,onClick:()=>s(!1),children:"Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©"}),k.jsx(f,{to:"/admin/offers",style:Ge.link,onClick:()=>s(!1),children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø±ÙˆØ¶"}),k.jsx(f,{to:"/admin/users",style:Ge.link,onClick:()=>s(!1),children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†"})]}),k.jsx("button",{onClick:()=>c(this,null,function*(){try{yield t(),i("/login")}catch(e){i("/login")}}),style:Ge.logoutBtn,type:"button",children:"ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬"})]})]})})}const Ge={nav:{background:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(20px) saturate(180%)",WebkitBackdropFilter:"blur(20px) saturate(180%)",boxShadow:"0 2px 20px rgba(31, 38, 135, 0.1)",marginBottom:"32px",position:"sticky",top:0,zIndex:100,borderBottom:"1px solid rgba(107, 124, 89, 0.1)"},container:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px 28px",position:"relative"},logo:{fontSize:"28px",fontWeight:"800",background:"linear-gradient(135deg, #6b7c59 0%, #556b2f 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",textDecoration:"none",zIndex:101,letterSpacing:"-0.5px",transition:"all 0.3s ease"},rightSection:{display:"flex",alignItems:"center",gap:"24px",zIndex:101},hamburger:{display:"none",fontSize:"28px",background:"none",border:"none",color:"#6b7c59",cursor:"pointer",padding:"8px",zIndex:101,transition:"all 0.3s ease"},menu:{display:"flex",gap:"28px",alignItems:"center"},link:{color:"#718096",textDecoration:"none",fontWeight:"600",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",whiteSpace:"nowrap",fontSize:"15px",position:"relative",padding:"8px 0"},notificationLink:{position:"relative",color:"#718096",textDecoration:"none",display:"flex",alignItems:"center",padding:"10px",transition:"all 0.3s ease",borderRadius:"12px"},bellIcon:{fontSize:"22px"},badge:{position:"absolute",top:"2px",right:"2px",background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"white",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:"700",border:"2px solid white",boxShadow:"0 2px 8px rgba(239, 68, 68, 0.4)",animation:"pulse 2s ease-in-out infinite"},logoutBtn:{padding:"10px 24px",background:"linear-gradient(135deg, #8b7355 0%, #6d5a42 100%)",color:"white",borderRadius:"20px",fontWeight:"600",whiteSpace:"nowrap",fontSize:"14px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 4px 12px rgba(139, 115, 85, 0.3)",border:"none"}};if("undefined"!=typeof window){const e=document.createElement("style");e.textContent="\n    .navbar-hamburger {\n      display: none;\n    }\n    \n    @media (max-width: 768px) {\n      .navbar-hamburger {\n        display: block !important;\n      }\n      \n      .navbar-menu {\n        position: absolute;\n        top: 100%;\n        left: 0;\n        right: 0;\n        background: rgba(17, 24, 39, 0.98);\n        backdrop-filter: blur(20px);\n        border: 1px solid rgba(107, 124, 89, 0.2);\n        flex-direction: column;\n        padding: 16px;\n        box-shadow: 0 4px 20px rgba(0,0,0,0.5);\n        gap: 12px !important;\n        align-items: stretch !important;\n        transition: all 0.3s ease;\n      }\n      \n      .navbar-menu.menu-closed {\n        display: none !important;\n      }\n      \n      .navbar-menu.menu-open {\n        display: flex !important;\n      }\n      \n      .navbar-menu a,\n      .navbar-menu button {\n        width: 100%;\n        text-align: center;\n        padding: 12px !important;\n        display: block;\n      }\n    }\n  ",document.head.appendChild(e)}function Ve(){const{user:e,profile:t,loadUser:i,isLoading:n}=ae();return p.useEffect(()=>{sessionStorage.getItem("app-initialized")||sessionStorage.setItem("app-initialized","true")},[]),p.useEffect(()=>{const e=()=>{const e=window.location.pathname;"/login"!==e&&"/signup"!==e&&localStorage.setItem("lastVisitedPage",e)};return e(),window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},[]),p.useEffect(()=>{i();const{data:{subscription:e}}=le.auth.onAuthStateChange(()=>{i()});return()=>{null==e||e.unsubscribe()}},[i]),n?k.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:k.jsx("div",{className:"spinner"})}):k.jsxs(y,{basename:"/bekya2.1",children:[k.jsx(pe,{}),e&&k.jsx(Ue,{}),k.jsxs(b,{children:[k.jsx(j,{path:"/login",element:e?k.jsx(v,{to:"/"}):k.jsx(ge,{})}),k.jsx(j,{path:"/signup",element:e?k.jsx(v,{to:"/"}):k.jsx(fe,{})}),k.jsx(j,{path:"/",element:e?k.jsx(_e,{}):k.jsx(v,{to:"/login"})}),k.jsx(j,{path:"/browse",element:e?k.jsx(ke,{}):k.jsx(v,{to:"/login"})}),k.jsx(j,{path:"/add-product",element:e?k.jsx(Be,{}):k.jsx(v,{to:"/login"})}),k.jsx(j,{path:"/edit-product/:id",element:e?k.jsx(Ie,{}):k.jsx(v,{to:"/login"})}),k.jsx(j,{path:"/profile",element:e?k.jsx(Te,{}):k.jsx(v,{to:"/login"})}),k.jsx(j,{path:"/notifications",element:e?k.jsx($e,{}):k.jsx(v,{to:"/login"})}),k.jsx(j,{path:"/product/:id",element:e?k.jsx(Fe,{}):k.jsx(v,{to:"/login"})}),k.jsx(j,{path:"/admin",element:e&&"admin"===(null==t?void 0:t.role)?k.jsx(De,{}):k.jsx(v,{to:"/"})}),k.jsx(j,{path:"/admin/offers",element:e&&"admin"===(null==t?void 0:t.role)?k.jsx(Pe,{}):k.jsx(v,{to:"/"})}),k.jsx(j,{path:"/admin/users",element:e&&"admin"===(null==t?void 0:t.role)?k.jsx(Ae,{}):k.jsx(v,{to:"/"})}),k.jsx(j,{path:"/set-admin",element:e?k.jsx(Me,{}):k.jsx(v,{to:"/login"})})]})]})}function Ze(){return k.jsx(de,{children:k.jsx(Ve,{})})}document.body.classList.add("netflix-theme"),N.createRoot(document.getElementById("root")).render(k.jsx(g.StrictMode,{children:k.jsx(Ze,{})}))}},function(){return _||(0,S[n(S)[0]])((_={exports:{}}).exports,_),_.exports});export default C();
